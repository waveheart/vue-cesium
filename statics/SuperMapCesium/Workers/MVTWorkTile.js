/**
 * Cesium - https://github.com/AnalyticalGraphicsInc/cesium
 *
 * Copyright 2011-2017 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md for full licensing details.
 */
/**
  @license
  when.js - https://github.com/cujojs/when

  MIT License (c) copyright B Cavalier & J Hann

 * A lightweight CommonJS Promises/A and when() implementation
 * when is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @version 1.7.1
 */

/**
@license
mersenne-twister.js - https://gist.github.com/banksean/300494

   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
   All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

     1. Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.

     2. Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.

     3. The names of its contributors may not be used to endorse or promote
        products derived from this software without specific prior written
        permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/* copyright sign */

!function(){!function(t){"use strict";t("ThirdParty/when",[],function(){function t(t,r,n,i){return e(t).then(r,n,i)}function e(t){var e,r;return t instanceof n?e=t:s(t)?(r=a(),t.then(function(t){r.resolve(t)},function(t){r.reject(t)},function(t){r.progress(t)}),e=r.promise):e=i(t),e}function r(e){return t(e,o)}function n(t){this.then=t}function i(t){return new n(function(r){try{return e(r?r(t):t)}catch(t){return o(t)}})}function o(t){return new n(function(r,n){try{return n?e(n(t)):o(t)}catch(t){return o(t)}})}function a(){function t(t,e,r){return f(t,e,r)}function r(t){return y(t)}function i(t){return y(o(t))}function s(t){return h(t)}var u,l,p,c,f,h,y;return l=new n(t),u={then:t,resolve:r,reject:i,progress:s,promise:l,resolver:{resolve:r,reject:i,progress:s}},p=[],c=[],f=function(t,e,r){var n,i;return n=a(),i="function"==typeof r?function(t){try{n.progress(r(t))}catch(t){n.progress(t)}}:function(t){n.progress(t)},p.push(function(r){r.then(t,e).then(n.resolve,n.reject,i)}),c.push(i),n.promise},h=function(t){return d(c,t),t},y=function(t){return t=e(t),f=t.then,y=e,h=v,d(p,t),c=p=w,t},u}function s(t){return t&&"function"==typeof t.then}function u(e,r,n,i,o){return m(2,arguments),t(e,function(e){function s(t){d(t)}function u(t){y(t)}var l,p,c,f,h,y,d,m,g,x;if(g=e.length>>>0,l=Math.max(0,Math.min(r,g)),c=[],p=g-l+1,f=[],h=a(),l)for(m=h.progress,d=function(t){f.push(t),--p||(y=d=v,h.reject(f))},y=function(t){c.push(t),--l||(y=d=v,h.resolve(c))},x=0;x<g;++x)x in e&&t(e[x],u,s,m);else h.resolve(c);return h.then(n,i,o)})}function l(t,e,r,n){function i(t){return e?e(t[0]):t[0]}return u(t,1,i,r,n)}function p(t,e,r,n){return m(1,arguments),f(t,g).then(e,r,n)}function c(){return f(arguments,g)}function f(e,r){return t(e,function(e){var n,i,o,s,u,l;if(o=i=e.length>>>0,n=[],l=a(),o)for(s=function(e,i){t(e,r).then(function(t){n[i]=t,--o||l.resolve(n)},l.reject)},u=0;u<i;u++)u in e?s(e[u],u):--o;else l.resolve(n);return l.promise})}function h(e,r){var n=b.call(arguments,1);return t(e,function(e){var i;return i=e.length,n[0]=function(e,n,o){return t(e,function(e){return t(n,function(t){return r(e,t,o,i)})})},x.apply(e,n)})}function y(e,r,n){var i=arguments.length>2;return t(e,function(t){return t=i?n:t,r.resolve(t),t},function(t){return r.reject(t),o(t)},r.progress)}function d(t,e){for(var r,n=0;r=t[n++];)r(e)}function m(t,e){for(var r,n=e.length;n>t;)if(null!=(r=e[--n])&&"function"!=typeof r)throw new Error("arg "+n+" must be a function")}function v(){}function g(t){return t}var x,b,w;return t.defer=a,t.resolve=e,t.reject=r,t.join=c,t.all=p,t.map=f,t.reduce=h,t.any=l,t.some=u,t.chain=y,t.isPromise=s,n.prototype={always:function(t,e){return this.then(t,t,e)},otherwise:function(t){return this.then(w,t)},yield:function(t){return this.then(function(){return t})},spread:function(t){return this.then(function(e){return p(e,function(e){return t.apply(w,e)})})}},b=[].slice,x=[].reduce||function(t){var e,r,n,i,o;if(o=0,e=Object(this),i=e.length>>>0,r=arguments,r.length<=1)for(;;){if(o in e){n=e[o++];break}if(++o>=i)throw new TypeError}else n=r[1];for(;o<i;++o)o in e&&(n=t(n,e[o],o,e));return n},t})}("function"==typeof define&&define.amd?define:function(t){"object"==typeof exports?module.exports=t():this.when=t()}),define("Core/defined",[],function(){"use strict";function t(t){return void 0!==t&&null!==t}return t}),define("Core/freezeObject",["./defined"],function(t){"use strict";var e=Object.freeze;return t(e)||(e=function(t){return t}),e}),define("Core/defaultValue",["./freezeObject"],function(t){"use strict";function e(t,e){return void 0!==t&&null!==t?t:e}return e.EMPTY_OBJECT=t({}),e}),define("Core/formatError",["./defined"],function(t){"use strict";function e(e){var r,n=e.name,i=e.message;r=t(n)&&t(i)?n+": "+i:e.toString();var o=e.stack;return t(o)&&(r+="\n"+o),r}return e}),define("Workers/createTaskProcessorWorker",["../ThirdParty/when","../Core/defaultValue","../Core/defined","../Core/formatError"],function(t,e,r,n){"use strict";function i(e,r,n){try{return e(r,n)}catch(e){return t.reject(e)}}function o(o){var a;return function(s){var u=s.data,l=[],p={id:u.id,result:void 0,error:void 0};return t(i(o,u.parameters,l)).then(function(t){p.result=t}).otherwise(function(t){t instanceof Error?p.error={name:t.name,message:t.message,stack:t.stack}:p.error=t}).always(function(){r(a)||(a=e(self.webkitPostMessage,self.postMessage)),u.canTransferArrayBuffer||(l.length=0);try{a(p,l)}catch(t){p.result=void 0,p.error="postMessage failed with error: "+n(t)+"\n  with responseMessage: "+JSON.stringify(p),a(p)}})}}return o}),define("Core/DeveloperError",["./defined"],function(t){"use strict";function e(t){this.name="DeveloperError",this.message=t;var e;try{throw new Error}catch(t){e=t.stack}this.stack=e}return t(Object.create)&&(e.prototype=Object.create(Error.prototype),e.prototype.constructor=e),e.prototype.toString=function(){var e=this.name+": "+this.message;return t(this.stack)&&(e+="\n"+this.stack.toString()),e},e.throwInstantiationError=function(){throw new e("This function defines an interface and should not be called directly.")},e}),define("Core/Check",["./defined","./DeveloperError"],function(t,e){"use strict";function r(t){return t+" is required, actual value was undefined"}function n(t,e,r){return"Expected "+r+" to be typeof "+e+", actual typeof was "+t}var i={};return i.typeOf={},i.defined=function(n,i){if(!t(i))throw new e(r(n))},i.typeOf.func=function(t,r){if("function"!=typeof r)throw new e(n(typeof r,"function",t))},i.typeOf.string=function(t,r){if("string"!=typeof r)throw new e(n(typeof r,"string",t))},i.typeOf.number=function(t,r){if("number"!=typeof r)throw new e(n(typeof r,"number",t))},i.typeOf.number.lessThan=function(t,r,n){if(i.typeOf.number(t,r),r>=n)throw new e("Expected "+t+" to be less than "+n+", actual value was "+r)},i.typeOf.number.lessThanOrEquals=function(t,r,n){if(i.typeOf.number(t,r),r>n)throw new e("Expected "+t+" to be less than or equal to "+n+", actual value was "+r)},i.typeOf.number.greaterThan=function(t,r,n){if(i.typeOf.number(t,r),r<=n)throw new e("Expected "+t+" to be greater than "+n+", actual value was "+r)},i.typeOf.number.greaterThanOrEquals=function(t,r,n){if(i.typeOf.number(t,r),r<n)throw new e("Expected "+t+" to be greater than or equal to"+n+", actual value was "+r)},i.typeOf.object=function(t,r){if("object"!=typeof r)throw new e(n(typeof r,"object",t))},i.typeOf.bool=function(t,r){if("boolean"!=typeof r)throw new e(n(typeof r,"boolean",t))},i.typeOf.number.equals=function(t,r,n,o){if(i.typeOf.number(t,n),i.typeOf.number(r,o),n!==o)throw new e(t+" must be equal to "+r+", the actual values are "+n+" and "+o)},i}),define("Core/defineProperties",["./defined"],function(t){"use strict";var e=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(t){return!1}}(),r=Object.defineProperties;return e&&t(r)||(r=function(t){return t}),r}),define("Core/Fullscreen",["./defined","./defineProperties"],function(t,e){"use strict";var r,n={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},i={};return e(i,{element:{get:function(){if(i.supportsFullscreen())return document[n.fullscreenElement]}},changeEventName:{get:function(){if(i.supportsFullscreen())return n.fullscreenchange}},errorEventName:{get:function(){if(i.supportsFullscreen())return n.fullscreenerror}},enabled:{get:function(){if(i.supportsFullscreen())return document[n.fullscreenEnabled]}},fullscreen:{get:function(){if(i.supportsFullscreen())return null!==i.element}}}),i.supportsFullscreen=function(){if(t(r))return r;r=!1;var e=document.body;if("function"==typeof e.requestFullscreen)return n.requestFullscreen="requestFullscreen",n.exitFullscreen="exitFullscreen",n.fullscreenEnabled="fullscreenEnabled",n.fullscreenElement="fullscreenElement",n.fullscreenchange="fullscreenchange",n.fullscreenerror="fullscreenerror",r=!0;for(var i,o=["webkit","moz","o","ms","khtml"],a=0,s=o.length;a<s;++a){var u=o[a];i=u+"RequestFullscreen","function"==typeof e[i]?(n.requestFullscreen=i,r=!0):(i=u+"RequestFullScreen","function"==typeof e[i]&&(n.requestFullscreen=i,r=!0)),i=u+"ExitFullscreen","function"==typeof document[i]?n.exitFullscreen=i:(i=u+"CancelFullScreen","function"==typeof document[i]&&(n.exitFullscreen=i)),i=u+"FullscreenEnabled",void 0!==document[i]?n.fullscreenEnabled=i:(i=u+"FullScreenEnabled",void 0!==document[i]&&(n.fullscreenEnabled=i)),i=u+"FullscreenElement",void 0!==document[i]?n.fullscreenElement=i:(i=u+"FullScreenElement",void 0!==document[i]&&(n.fullscreenElement=i)),i=u+"fullscreenchange",void 0!==document["on"+i]&&("ms"===u&&(i="MSFullscreenChange"),n.fullscreenchange=i),i=u+"fullscreenerror",void 0!==document["on"+i]&&("ms"===u&&(i="MSFullscreenError"),n.fullscreenerror=i)}return r},i.requestFullscreen=function(t,e){i.supportsFullscreen()&&t[n.requestFullscreen]({vrDisplay:e})},i.exitFullscreen=function(){i.supportsFullscreen()&&document[n.exitFullscreen]()},i}),define("Core/RuntimeError",["./defined"],function(t){"use strict";function e(t){this.name="RuntimeError",this.message=t;var e;try{throw new Error}catch(t){e=t.stack}this.stack=e}return t(Object.create)&&(e.prototype=Object.create(Error.prototype),e.prototype.constructor=e),e.prototype.toString=function(){var e=this.name+": "+this.message;return t(this.stack)&&(e+="\n"+this.stack.toString()),e},e}),define("Core/FeatureDetection",["./defaultValue","./defined","./Fullscreen","./RuntimeError","../ThirdParty/when"],function(t,e,r,n,i){"use strict";function o(t){for(var e=t.split("."),r=0,n=e.length;r<n;++r)e[r]=parseInt(e[r],10);return e}function a(){if(!e(k)&&(k=!1,!y())){var t=/ Chrome\/([\.0-9]+)/.exec(E.userAgent);null!==t&&(k=!0,I=o(t[1]))}return k}function s(){return a()&&I}function u(){if(!e(F)&&(F=!1,!a()&&!y()&&/ Safari\/[\.0-9]+/.test(E.userAgent))){var t=/ Version\/([\.0-9]+)/.exec(E.userAgent);null!==t&&(F=!0,V=o(t[1]))}return F}function l(){return u()&&V}function p(){if(!e(M)){M=!1;var t=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(E.userAgent);null!==t&&(M=!0,P=o(t[1]),P.isNightly=!!t[2])}return M}function c(){return p()&&P}function f(){if(!e(T)){T=!1;var t;"Microsoft Internet Explorer"===E.appName?null!==(t=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(E.userAgent))&&(T=!0,z=o(t[1])):"Netscape"===E.appName&&null!==(t=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(E.userAgent))&&(T=!0,z=o(t[1]))}return T}function h(){return f()&&z}function y(){if(!e(B)){B=!1;var t=/ Edge\/([\.0-9]+)/.exec(E.userAgent);null!==t&&(B=!0,O=o(t[1]))}return B}function d(){return y()&&O}function m(){if(!e(D)){D=!1;var t=/Firefox\/([\.0-9]+)/.exec(E.userAgent);null!==t&&(D=!0,L=o(t[1]))}return D}function v(){return e(R)||(R=/Windows/i.test(E.appVersion)),R}function g(){return m()&&L}function x(){return e(q)||(q="object"==typeof process&&"[object process]"===Object.prototype.toString.call(process)),q}function b(){return e(U)||(U=!m()&&"undefined"!=typeof PointerEvent&&(!e(E.pointerEnabled)||E.pointerEnabled)),U}function w(){if(!e(j)){var t=document.createElement("canvas");t.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var r=t.style.imageRendering;j=e(r)&&""!==r,j&&(N=r)}return j}function _(){return w()?N:void 0}function C(){if(e(K))return K.promise;K=i.defer(),y()&&(G=!1,K.resolve(G));var t=new Image;return t.onload=function(){G=t.width>0&&t.height>0,K.resolve(G)},t.onerror=function(){G=!1,K.resolve(G)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",K.promise}function A(){return e(K)||C(),G}function S(){var t=window.navigator.userAgent.toLowerCase(),e="ipad"==t.match(/ipad/i),r="iphone os"==t.match(/iphone os/i),n="midp"==t.match(/midp/i),i="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),o="ucweb"==t.match(/ucweb/i),a="android"==t.match(/android/i),s="windows ce"==t.match(/windows ce/i),u="windows mobile"==t.match(/windows mobile/i);return!(e||r||n||i||o||a||s||u)}var E;E="undefined"!=typeof navigator?navigator:{};var k,I,F,V,M,P,T,z,B,O,D,L,R,q,U,N,j,G,K,H=[];"undefined"!=typeof ArrayBuffer&&(H.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&H.push(Uint8ClampedArray),"undefined"!=typeof CanvasPixelArray&&H.push(CanvasPixelArray));var Y={isChrome:a,chromeVersion:s,isSafari:u,safariVersion:l,isWebkit:p,webkitVersion:c,isInternetExplorer:f,internetExplorerVersion:h,isEdge:y,edgeVersion:d,isFirefox:m,firefoxVersion:g,isWindows:v,isNodeJs:x,hardwareConcurrency:t(E.hardwareConcurrency,3),supportsPointerEvents:b,supportsImageRenderingPixelated:w,supportsWebP:C,supportsWebPSync:A,imageRenderingValue:_,typedArrayTypes:H,isPCBroswer:S};return Y.supportsFullscreen=function(){return r.supportsFullscreen()},Y.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},Y.supportsWebWorkers=function(){return"undefined"!=typeof Worker},Y.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly&&!Y.isEdge()},Y.supportsOffscreenCanvas=function(){return"undefined"!=typeof OffscreenCanvas&&!Y.isEdge()},Y}),define("ThirdParty/mersenne-twister",[],function(){var t=function(t){void 0==t&&(t=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(t)};return t.prototype.init_genrand=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){var t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0}},t.prototype.genrand_int32=function(){var t,e=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var r;for(this.mti==this.N+1&&this.init_genrand(5489),r=0;r<this.N-this.M;r++)t=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+this.M]^t>>>1^e[1&t];for(;r<this.N-1;r++)t=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+(this.M-this.N)]^t>>>1^e[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^e[1&t],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0},t.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},t}),define("Core/Math",["../ThirdParty/mersenne-twister","./Check","./defaultValue","./defined","./DeveloperError"],function(t,e,r,n,i){"use strict";var o={};o.Radius=6378137,o.EPSILON1=.1,o.EPSILON2=.01,o.EPSILON3=.001,o.EPSILON4=1e-4,o.EPSILON5=1e-5,o.EPSILON6=1e-6,o.EPSILON7=1e-7,o.EPSILON8=1e-8,o.EPSILON9=1e-9,o.EPSILON10=1e-10,o.EPSILON11=1e-11,o.EPSILON12=1e-12,o.EPSILON13=1e-13,o.EPSILON14=1e-14,o.EPSILON15=1e-15,o.EPSILON16=1e-16,o.EPSILON17=1e-17,o.EPSILON18=1e-18,o.EPSILON19=1e-19,o.EPSILON20=1e-20,o.EPSILON21=1e-21,o.GRAVITATIONALPARAMETER=3986004418e5,o.SOLAR_RADIUS=6955e5,o.LUNAR_RADIUS=1737400,o.SIXTY_FOUR_KILOBYTES=65536,o.sign=r(Math.sign,function(t){return t=+t,0===t||t!==t?t:t>0?1:-1}),o.signNotZero=function(t){return t<0?-1:1},o.toSNorm=function(t,e){return e=r(e,255),Math.round((.5*o.clamp(t,-1,1)+.5)*e)},o.fromSNorm=function(t,e){return e=r(e,255),o.clamp(t,0,e)/e*2-1},o.sinh=r(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2}),o.cosh=r(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2}),o.lerp=function(t,e,r){return(1-r)*t+r*e},o.PI=Math.PI,o.ONE_OVER_PI=1/Math.PI,o.PI_OVER_TWO=Math.PI/2,o.PI_OVER_THREE=Math.PI/3,o.PI_OVER_FOUR=Math.PI/4,o.PI_OVER_SIX=Math.PI/6,o.THREE_PI_OVER_TWO=3*Math.PI/2,o.TWO_PI=2*Math.PI,o.ONE_OVER_TWO_PI=1/(2*Math.PI),o.RADIANS_PER_DEGREE=Math.PI/180,o.DEGREES_PER_RADIAN=180/Math.PI,o.RADIANS_PER_ARCSECOND=o.RADIANS_PER_DEGREE/3600,o.toRadians=function(t){if(!n(t))throw new i("degrees is required.");return t*o.RADIANS_PER_DEGREE},o.toDegrees=function(t){if(!n(t))throw new i("radians is required.");return t*o.DEGREES_PER_RADIAN},o.convertLongitudeRange=function(t){if(!n(t))throw new i("angle is required.");var e=o.TWO_PI,r=t-Math.floor(t/e)*e;return r<-Math.PI?r+e:r>=Math.PI?r-e:r},o.clampToLatitudeRange=function(t){if(!n(t))throw new i("angle is required.");return o.clamp(t,-1*o.PI_OVER_TWO,o.PI_OVER_TWO)},o.negativePiToPi=function(t){if(!n(t))throw new i("angle is required.");return o.zeroToTwoPi(t+o.PI)-o.PI},o.zeroToTwoPi=function(t){if(!n(t))throw new i("angle is required.");var e=o.mod(t,o.TWO_PI);return Math.abs(e)<o.EPSILON14&&Math.abs(t)>o.EPSILON14?o.TWO_PI:e},o.mod=function(t,e){if(!n(t))throw new i("m is required.");if(!n(e))throw new i("n is required.");return(t%e+e)%e},o.equalsEpsilon=function(t,e,o,a){if(!n(t))throw new i("left is required.");if(!n(e))throw new i("right is required.");if(!n(o))throw new i("relativeEpsilon is required.");a=r(a,o);var s=Math.abs(t-e);return s<=a||s<=o*Math.max(Math.abs(t),Math.abs(e))},o.lessThan=function(t,e,r){if(!n(t))throw new i("first is required.");if(!n(e))throw new i("second is required.");if(!n(r))throw new i("relativeEpsilon is required.");return t-e<-r},o.lessThanOrEquals=function(t,e,r){if(!n(t))throw new i("first is required.");if(!n(e))throw new i("second is required.");if(!n(r))throw new i("relativeEpsilon is required.");return t-e<r},o.greaterThan=function(t,e,r){if(!n(t))throw new i("first is required.");if(!n(e))throw new i("second is required.");if(!n(r))throw new i("relativeEpsilon is required.");return t-e>r},o.greaterThanOrEquals=function(t,e,r){if(!n(t))throw new i("first is required.");if(!n(e))throw new i("second is required.");if(!n(r))throw new i("relativeEpsilon is required.");return t-e>-r};var a=[1];o.factorial=function(t){if("number"!=typeof t||t<0)throw new i("A number greater than or equal to 0 is required.");var e=a.length;if(t>=e)for(var r=a[e-1],n=e;n<=t;n++)a.push(r*n);return a[t]},o.incrementWrap=function(t,e,o){if(o=r(o,0),!n(t))throw new i("n is required.");if(e<=o)throw new i("maximumValue must be greater than minimumValue.");return++t,t>e&&(t=o),t},o.isPowerOfTwo=function(t){if("number"!=typeof t||t<0)throw new i("A number greater than or equal to 0 is required.");return 0!==t&&0==(t&t-1)},o.nextPowerOfTwo=function(t){if("number"!=typeof t||t<0)throw new i("A number greater than or equal to 0 is required.");return--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},o.clamp=function(t,e,r){if(!n(t))throw new i("value is required");if(!n(e))throw new i("min is required.");if(!n(r))throw new i("max is required.");return t<e?e:t>r?r:t};var s=new t;return o.setRandomNumberSeed=function(e){if(!n(e))throw new i("seed is required.");s=new t(e)},o.nextRandomNumber=function(){return s.random()},o.randomBetween=function(t,e){return o.nextRandomNumber()*(e-t)+t},o.acosClamped=function(t){if(!n(t))throw new i("value is required.");return Math.acos(o.clamp(t,-1,1))},o.asinClamped=function(t){if(!n(t))throw new i("value is required.");return Math.asin(o.clamp(t,-1,1))},o.chordLength=function(t,e){if(!n(t))throw new i("angle is required.");if(!n(e))throw new i("radius is required.");return 2*e*Math.sin(.5*t)},o.logBase=function(t,e){if(!n(t))throw new i("number is required.");if(!n(e))throw new i("base is required.");return Math.log(t)/Math.log(e)},o.cbrt=r(Math.cbrt,function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}),o.log2=r(Math.log2,function(t){return Math.log(t)*Math.LOG2E}),o.fog=function(t,e){var r=t*e;return 1-Math.exp(-r*r)},o.fastApproximateAtan=function(t){return e.typeOf.number("x",t),t*(-.1784*Math.abs(t)-.0663*t*t+1.0301)},o.fastApproximateAtan2=function(t,r){e.typeOf.number("x",t),e.typeOf.number("y",r);var n,a,s=Math.abs(t);n=Math.abs(r),a=Math.max(s,n),n=Math.min(s,n);var u=n/a;if(isNaN(u))throw new i("either x or y must be nonzero");return s=o.fastApproximateAtan(u),s=Math.abs(r)>Math.abs(t)?o.PI_OVER_TWO-s:s,s=t<0?o.PI-s:s,s=r<0?-s:s},o}),define("Core/Color",["./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math"],function(t,e,r,n,i,o){"use strict";function a(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),6*r<1?t+6*(e-t)*r:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}function s(t,r,n,i){this.red=e(t,1),this.green=e(r,1),this.blue=e(n,1),this.alpha=e(i,1)}s.fromCartesian4=function(e,n){return t.typeOf.object("cartesian",e),r(n)?(n.red=e.x,n.green=e.y,n.blue=e.z,n.alpha=e.w,n):new s(e.x,e.y,e.z,e.w)},s.fromBytes=function(t,n,i,o,a){return t=s.byteToFloat(e(t,255)),n=s.byteToFloat(e(n,255)),i=s.byteToFloat(e(i,255)),o=s.byteToFloat(e(o,255)),r(a)?(a.red=t,a.green=n,a.blue=i,a.alpha=o,a):new s(t,n,i,o)},s.fromAlpha=function(e,n,i){return t.typeOf.object("color",e),t.typeOf.number("alpha",n),r(i)?(i.red=e.red,i.green=e.green,i.blue=e.blue,i.alpha=n,i):new s(e.red,e.green,e.blue,n)};var u,l,p;n.supportsTypedArrays()&&(u=new ArrayBuffer(4),l=new Uint32Array(u),p=new Uint8Array(u)),s.fromRgba=function(t,e){return l[0]=t,s.fromBytes(p[0],p[1],p[2],p[3],e)},s.fromHsl=function(t,n,i,o,u){t=e(t,0)%1,n=e(n,0),i=e(i,0),o=e(o,1);var l=i,p=i,c=i;if(0!==n){var f;f=i<.5?i*(1+n):i+n-i*n;var h=2*i-f;l=a(h,f,t+1/3),p=a(h,f,t),c=a(h,f,t-1/3)}return r(u)?(u.red=l,u.green=p,u.blue=c,u.alpha=o,u):new s(l,p,c,o)},s.fromRandom=function(n,i){n=e(n,e.EMPTY_OBJECT);var a=n.red;if(!r(a)){var u=e(n.minimumRed,0),l=e(n.maximumRed,1);t.typeOf.number.lessThanOrEquals("minimumRed",u,l),a=u+o.nextRandomNumber()*(l-u)}var p=n.green;if(!r(p)){var c=e(n.minimumGreen,0),f=e(n.maximumGreen,1);t.typeOf.number.lessThanOrEquals("minimumGreen",c,f),p=c+o.nextRandomNumber()*(f-c)}var h=n.blue;if(!r(h)){var y=e(n.minimumBlue,0),d=e(n.maximumBlue,1);t.typeOf.number.lessThanOrEquals("minimumBlue",y,d),h=y+o.nextRandomNumber()*(d-y)}var m=n.alpha;if(!r(m)){var v=e(n.minimumAlpha,0),g=e(n.maximumAlpha,1);t.typeOf.number.lessThanOrEquals("minumumAlpha",v,g),m=v+o.nextRandomNumber()*(g-v)}return r(i)?(i.red=a,i.green=p,i.blue=h,i.alpha=m,i):new s(a,p,h,m)};var c=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,f=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,h=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,y=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;return s.fromCssColorString=function(n,i){t.typeOf.string("color",n),r(i)||(i=new s);var o=s[n.toUpperCase()];if(r(o))return s.clone(o,i),i;var a=c.exec(n);return null!==a?(i.red=parseInt(a[1],16)/15,i.green=parseInt(a[2],16)/15,i.blue=parseInt(a[3],16)/15,i.alpha=1,i):null!==(a=f.exec(n))?(i.red=parseInt(a[1],16)/255,i.green=parseInt(a[2],16)/255,i.blue=parseInt(a[3],16)/255,i.alpha=1,i):null!==(a=h.exec(n))?(i.red=parseFloat(a[1])/("%"===a[1].substr(-1)?100:255),i.green=parseFloat(a[2])/("%"===a[2].substr(-1)?100:255),i.blue=parseFloat(a[3])/("%"===a[3].substr(-1)?100:255),i.alpha=parseFloat(e(a[4],"1.0")),i):null!==(a=y.exec(n))?s.fromHsl(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,parseFloat(e(a[4],"1.0")),i):i=void 0},s.packedLength=4,s.pack=function(r,n,i){return t.typeOf.object("value",r),t.defined("array",n),i=e(i,0),n[i++]=r.red,n[i++]=r.green,n[i++]=r.blue,n[i]=r.alpha,n},s.unpack=function(n,i,o){return t.defined("array",n),i=e(i,0),r(o)||(o=new s),o.red=n[i++],o.green=n[i++],o.blue=n[i++],o.alpha=n[i],o},s.byteToFloat=function(t){return t/255},s.floatToByte=function(t){return 1===t?255:256*t|0},s.clone=function(t,e){if(r(t))return r(e)?(e.red=t.red,e.green=t.green,e.blue=t.blue,e.alpha=t.alpha,e):new s(t.red,t.green,t.blue,t.alpha)},s.equals=function(t,e){return t===e||r(t)&&r(e)&&t.red===e.red&&t.green===e.green&&t.blue===e.blue&&t.alpha===e.alpha},s.equalsArray=function(t,e,r){return t.red===e[r]&&t.green===e[r+1]&&t.blue===e[r+2]&&t.alpha===e[r+3]},s.prototype.clone=function(t){return s.clone(this,t)},s.prototype.equals=function(t){return s.equals(this,t)},s.prototype.equalsEpsilon=function(t,e){return this===t||r(t)&&Math.abs(this.red-t.red)<=e&&Math.abs(this.green-t.green)<=e&&Math.abs(this.blue-t.blue)<=e&&Math.abs(this.alpha-t.alpha)<=e},s.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},s.prototype.toCssColorString=function(){var t=s.floatToByte(this.red),e=s.floatToByte(this.green),r=s.floatToByte(this.blue);return 1===this.alpha?"rgb("+t+","+e+","+r+")":"rgba("+t+","+e+","+r+","+this.alpha+")"},s.prototype.toBytes=function(t){var e=s.floatToByte(this.red),n=s.floatToByte(this.green),i=s.floatToByte(this.blue),o=s.floatToByte(this.alpha);return r(t)?(t[0]=e,t[1]=n,t[2]=i,t[3]=o,t):[e,n,i,o]},s.prototype.toRgba=function(){return p[0]=s.floatToByte(this.red),p[1]=s.floatToByte(this.green),p[2]=s.floatToByte(this.blue),p[3]=s.floatToByte(this.alpha),l[0]},s.prototype.brighten=function(e,r){return t.typeOf.number("magnitude",e),t.typeOf.number.greaterThanOrEquals("magnitude",e,0),t.typeOf.object("result",r),e=1-e,r.red=1-(1-this.red)*e,r.green=1-(1-this.green)*e,r.blue=1-(1-this.blue)*e,r.alpha=this.alpha,r},s.prototype.darken=function(e,r){return t.typeOf.number("magnitude",e),t.typeOf.number.greaterThanOrEquals("magnitude",e,0),t.typeOf.object("result",r),e=1-e,r.red=this.red*e,r.green=this.green*e,r.blue=this.blue*e,r.alpha=this.alpha,r},s.prototype.withAlpha=function(t,e){return s.fromAlpha(this,t,e)},s.add=function(e,r,n){return t.typeOf.object("left",e),t.typeOf.object("right",r),t.typeOf.object("result",n),n.red=e.red+r.red,n.green=e.green+r.green,n.blue=e.blue+r.blue,n.alpha=e.alpha+r.alpha,n},s.subtract=function(e,r,n){return t.typeOf.object("left",e),t.typeOf.object("right",r),t.typeOf.object("result",n),n.red=e.red-r.red,n.green=e.green-r.green,n.blue=e.blue-r.blue,n.alpha=e.alpha-r.alpha,n},s.multiply=function(e,r,n){return t.typeOf.object("left",e),t.typeOf.object("right",r),t.typeOf.object("result",n),n.red=e.red*r.red,n.green=e.green*r.green,n.blue=e.blue*r.blue,n.alpha=e.alpha*r.alpha,n},s.divide=function(e,r,n){return t.typeOf.object("left",e),t.typeOf.object("right",r),t.typeOf.object("result",n),n.red=e.red/r.red,n.green=e.green/r.green,n.blue=e.blue/r.blue,n.alpha=e.alpha/r.alpha,n},s.mod=function(e,r,n){return t.typeOf.object("left",e),t.typeOf.object("right",r),t.typeOf.object("result",n),n.red=e.red%r.red,n.green=e.green%r.green,n.blue=e.blue%r.blue,n.alpha=e.alpha%r.alpha,n},s.multiplyByScalar=function(e,r,n){return t.typeOf.object("color",e),t.typeOf.number("scalar",r),t.typeOf.object("result",n),n.red=e.red*r,n.green=e.green*r,n.blue=e.blue*r,n.alpha=e.alpha*r,n},s.divideByScalar=function(e,r,n){return t.typeOf.object("color",e),t.typeOf.number("scalar",r),t.typeOf.object("result",n),n.red=e.red/r,n.green=e.green/r,n.blue=e.blue/r,n.alpha=e.alpha/r,n},s.ALICEBLUE=i(s.fromCssColorString("#F0F8FF")),s.ANTIQUEWHITE=i(s.fromCssColorString("#FAEBD7")),s.AQUA=i(s.fromCssColorString("#00FFFF")),s.AQUAMARINE=i(s.fromCssColorString("#7FFFD4")),s.AZURE=i(s.fromCssColorString("#F0FFFF")),s.BEIGE=i(s.fromCssColorString("#F5F5DC")),s.BISQUE=i(s.fromCssColorString("#FFE4C4")),s.BLACK=i(s.fromCssColorString("#000000")),s.BLANCHEDALMOND=i(s.fromCssColorString("#FFEBCD")),s.BLUE=i(s.fromCssColorString("#0000FF")),s.BLUEVIOLET=i(s.fromCssColorString("#8A2BE2")),s.BROWN=i(s.fromCssColorString("#A52A2A")),s.BURLYWOOD=i(s.fromCssColorString("#DEB887")),s.CADETBLUE=i(s.fromCssColorString("#5F9EA0")),s.CHARTREUSE=i(s.fromCssColorString("#7FFF00")),s.CHOCOLATE=i(s.fromCssColorString("#D2691E")),s.CORAL=i(s.fromCssColorString("#FF7F50")),s.CORNFLOWERBLUE=i(s.fromCssColorString("#6495ED")),s.CORNSILK=i(s.fromCssColorString("#FFF8DC")),s.CRIMSON=i(s.fromCssColorString("#DC143C")),s.CYAN=i(s.fromCssColorString("#00FFFF")),s.DARKBLUE=i(s.fromCssColorString("#00008B")),s.DARKCYAN=i(s.fromCssColorString("#008B8B")),s.DARKGOLDENROD=i(s.fromCssColorString("#B8860B")),s.DARKGRAY=i(s.fromCssColorString("#A9A9A9")),s.DARKGREEN=i(s.fromCssColorString("#006400")),s.DARKGREY=s.DARKGRAY,s.DARKKHAKI=i(s.fromCssColorString("#BDB76B")),s.DARKMAGENTA=i(s.fromCssColorString("#8B008B")),s.DARKOLIVEGREEN=i(s.fromCssColorString("#556B2F")),s.DARKORANGE=i(s.fromCssColorString("#FF8C00")),s.DARKORCHID=i(s.fromCssColorString("#9932CC")),s.DARKRED=i(s.fromCssColorString("#8B0000")),s.DARKSALMON=i(s.fromCssColorString("#E9967A")),s.DARKSEAGREEN=i(s.fromCssColorString("#8FBC8F")),s.DARKSLATEBLUE=i(s.fromCssColorString("#483D8B")),s.DARKSLATEGRAY=i(s.fromCssColorString("#2F4F4F")),s.DARKSLATEGREY=s.DARKSLATEGRAY,s.DARKTURQUOISE=i(s.fromCssColorString("#00CED1")),s.DARKVIOLET=i(s.fromCssColorString("#9400D3")),s.DEEPPINK=i(s.fromCssColorString("#FF1493")),s.DEEPSKYBLUE=i(s.fromCssColorString("#00BFFF")),s.DIMGRAY=i(s.fromCssColorString("#696969")),s.DIMGREY=s.DIMGRAY,s.DODGERBLUE=i(s.fromCssColorString("#1E90FF")),s.FIREBRICK=i(s.fromCssColorString("#B22222")),s.FLORALWHITE=i(s.fromCssColorString("#FFFAF0")),s.FORESTGREEN=i(s.fromCssColorString("#228B22")),s.FUCHSIA=i(s.fromCssColorString("#FF00FF")),s.GAINSBORO=i(s.fromCssColorString("#DCDCDC")),s.GHOSTWHITE=i(s.fromCssColorString("#F8F8FF")),s.GOLD=i(s.fromCssColorString("#FFD700")),s.GOLDENROD=i(s.fromCssColorString("#DAA520")),s.GRAY=i(s.fromCssColorString("#808080")),s.GREEN=i(s.fromCssColorString("#008000")),s.GREENYELLOW=i(s.fromCssColorString("#ADFF2F")),s.GREY=s.GRAY,s.HONEYDEW=i(s.fromCssColorString("#F0FFF0")),s.HOTPINK=i(s.fromCssColorString("#FF69B4")),s.INDIANRED=i(s.fromCssColorString("#CD5C5C")),s.INDIGO=i(s.fromCssColorString("#4B0082")),s.IVORY=i(s.fromCssColorString("#FFFFF0")),s.KHAKI=i(s.fromCssColorString("#F0E68C")),s.LAVENDER=i(s.fromCssColorString("#E6E6FA")),s.LAVENDAR_BLUSH=i(s.fromCssColorString("#FFF0F5")),s.LAWNGREEN=i(s.fromCssColorString("#7CFC00")),s.LEMONCHIFFON=i(s.fromCssColorString("#FFFACD")),s.LIGHTBLUE=i(s.fromCssColorString("#ADD8E6")),s.LIGHTCORAL=i(s.fromCssColorString("#F08080")),s.LIGHTCYAN=i(s.fromCssColorString("#E0FFFF")),s.LIGHTGOLDENRODYELLOW=i(s.fromCssColorString("#FAFAD2")),s.LIGHTGRAY=i(s.fromCssColorString("#D3D3D3")),s.LIGHTGREEN=i(s.fromCssColorString("#90EE90")),s.LIGHTGREY=s.LIGHTGRAY,s.LIGHTPINK=i(s.fromCssColorString("#FFB6C1")),s.LIGHTSEAGREEN=i(s.fromCssColorString("#20B2AA")),s.LIGHTSKYBLUE=i(s.fromCssColorString("#87CEFA")),s.LIGHTSLATEGRAY=i(s.fromCssColorString("#778899")),s.LIGHTSLATEGREY=s.LIGHTSLATEGRAY,s.LIGHTSTEELBLUE=i(s.fromCssColorString("#B0C4DE")),s.LIGHTYELLOW=i(s.fromCssColorString("#FFFFE0")),s.LIME=i(s.fromCssColorString("#00FF00")),s.LIMEGREEN=i(s.fromCssColorString("#32CD32")),s.LINEN=i(s.fromCssColorString("#FAF0E6")),s.MAGENTA=i(s.fromCssColorString("#FF00FF")),s.MAROON=i(s.fromCssColorString("#800000")),s.MEDIUMAQUAMARINE=i(s.fromCssColorString("#66CDAA")),s.MEDIUMBLUE=i(s.fromCssColorString("#0000CD")),s.MEDIUMORCHID=i(s.fromCssColorString("#BA55D3")),s.MEDIUMPURPLE=i(s.fromCssColorString("#9370DB")),s.MEDIUMSEAGREEN=i(s.fromCssColorString("#3CB371")),s.MEDIUMSLATEBLUE=i(s.fromCssColorString("#7B68EE")),s.MEDIUMSPRINGGREEN=i(s.fromCssColorString("#00FA9A")),s.MEDIUMTURQUOISE=i(s.fromCssColorString("#48D1CC")),s.MEDIUMVIOLETRED=i(s.fromCssColorString("#C71585")),s.MIDNIGHTBLUE=i(s.fromCssColorString("#191970")),s.MINTCREAM=i(s.fromCssColorString("#F5FFFA")),s.MISTYROSE=i(s.fromCssColorString("#FFE4E1")),s.MOCCASIN=i(s.fromCssColorString("#FFE4B5")),s.NAVAJOWHITE=i(s.fromCssColorString("#FFDEAD")),s.NAVY=i(s.fromCssColorString("#000080")),s.OLDLACE=i(s.fromCssColorString("#FDF5E6")),s.OLIVE=i(s.fromCssColorString("#808000")),s.OLIVEDRAB=i(s.fromCssColorString("#6B8E23")),s.ORANGE=i(s.fromCssColorString("#FFA500")),s.ORANGERED=i(s.fromCssColorString("#FF4500")),s.ORCHID=i(s.fromCssColorString("#DA70D6")),s.PALEGOLDENROD=i(s.fromCssColorString("#EEE8AA")),s.PALEGREEN=i(s.fromCssColorString("#98FB98")),s.PALETURQUOISE=i(s.fromCssColorString("#AFEEEE")),s.PALEVIOLETRED=i(s.fromCssColorString("#DB7093")),s.PAPAYAWHIP=i(s.fromCssColorString("#FFEFD5")),s.PEACHPUFF=i(s.fromCssColorString("#FFDAB9")),s.PERU=i(s.fromCssColorString("#CD853F")),s.PINK=i(s.fromCssColorString("#FFC0CB")),s.PLUM=i(s.fromCssColorString("#DDA0DD")),s.POWDERBLUE=i(s.fromCssColorString("#B0E0E6")),
s.PURPLE=i(s.fromCssColorString("#800080")),s.RED=i(s.fromCssColorString("#FF0000")),s.ROSYBROWN=i(s.fromCssColorString("#BC8F8F")),s.ROYALBLUE=i(s.fromCssColorString("#4169E1")),s.SADDLEBROWN=i(s.fromCssColorString("#8B4513")),s.SALMON=i(s.fromCssColorString("#FA8072")),s.SANDYBROWN=i(s.fromCssColorString("#F4A460")),s.SEAGREEN=i(s.fromCssColorString("#2E8B57")),s.SEASHELL=i(s.fromCssColorString("#FFF5EE")),s.SIENNA=i(s.fromCssColorString("#A0522D")),s.SILVER=i(s.fromCssColorString("#C0C0C0")),s.SKYBLUE=i(s.fromCssColorString("#87CEEB")),s.SLATEBLUE=i(s.fromCssColorString("#6A5ACD")),s.SLATEGRAY=i(s.fromCssColorString("#708090")),s.SLATEGREY=s.SLATEGRAY,s.SNOW=i(s.fromCssColorString("#FFFAFA")),s.SPRINGGREEN=i(s.fromCssColorString("#00FF7F")),s.STEELBLUE=i(s.fromCssColorString("#4682B4")),s.TAN=i(s.fromCssColorString("#D2B48C")),s.TEAL=i(s.fromCssColorString("#008080")),s.THISTLE=i(s.fromCssColorString("#D8BFD8")),s.TOMATO=i(s.fromCssColorString("#FF6347")),s.TURQUOISE=i(s.fromCssColorString("#40E0D0")),s.VIOLET=i(s.fromCssColorString("#EE82EE")),s.WHEAT=i(s.fromCssColorString("#F5DEB3")),s.WHITE=i(s.fromCssColorString("#FFFFFF")),s.WHITESMOKE=i(s.fromCssColorString("#F5F5F5")),s.YELLOW=i(s.fromCssColorString("#FFFF00")),s.YELLOWGREEN=i(s.fromCssColorString("#9ACD32")),s.TRANSPARENT=i(new s(0,0,0,0)),s}),define("ThirdParty/pbf",[],function(){function t(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function e(t,e,r){var i,o,a=r.buf;if(o=a[r.pos++],i=(112&o)>>4,o<128)return n(t,i,e);if(o=a[r.pos++],i|=(127&o)<<3,o<128)return n(t,i,e);if(o=a[r.pos++],i|=(127&o)<<10,o<128)return n(t,i,e);if(o=a[r.pos++],i|=(127&o)<<17,o<128)return n(t,i,e);if(o=a[r.pos++],i|=(127&o)<<24,o<128)return n(t,i,e);if(o=a[r.pos++],i|=(1&o)<<31,o<128)return n(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function r(e){return e.type===t.Bytes?e.readVarint()+e.pos:e.pos+1}function n(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function i(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(r=~(-t%4294967296),n=~(-t/4294967296),4294967295^r?r=r+1|0:(r=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),o(r,n,e),a(n,e)}function o(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}function a(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}function s(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function u(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function l(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function p(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function c(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function f(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function h(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function y(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function d(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function m(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function v(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function g(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function b(t,e,r){for(var n="",i=e;i<r;){var o=t[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>r)break;var u,l,p;1===s?o<128&&(a=o):2===s?128==(192&(u=t[i+1]))&&(a=(31&o)<<6|63&u)<=127&&(a=null):3===s?(u=t[i+1],l=t[i+2],128==(192&u)&&128==(192&l)&&((a=(15&o)<<12|(63&u)<<6|63&l)<=2047||a>=55296&&a<=57343)&&(a=null)):4===s&&(u=t[i+1],l=t[i+2],p=t[i+3],128==(192&u)&&128==(192&l)&&128==(192&p)&&((a=(15&o)<<18|(63&u)<<12|(63&l)<<6|63&p)<=65535||a>=1114112)&&(a=null)),null===a?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|1023&a),n+=String.fromCharCode(a),i+=s}return n}function w(t,e,r){for(var n,i,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}var _=function(t,e,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,p=-7,c=r?i-1:0,f=r?-1:1,h=t[e+c];for(c+=f,o=h&(1<<-p)-1,h>>=-p,p+=s;p>0;o=256*o+t[e+c],c+=f,p-=8);for(a=o&(1<<-p)-1,o>>=-p,p+=n;p>0;a=256*a+t[e+c],c+=f,p-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),o-=l}return(h?-1:1)*a*Math.pow(2,o-n)},C=function(t,e,r,n,i,o){var a,s,u,l=8*o-i-1,p=(1<<l)-1,c=p>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,y=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=p):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+c>=1?f/u:f*Math.pow(2,1-c),e*u>=2&&(a++,u/=2),a+c>=p?(s=0,a=p):a+c>=1?(s=(e*u-1)*Math.pow(2,i),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;t[r+h]=255&s,h+=y,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;t[r+h]=255&a,h+=y,a/=256,l-=8);t[r+h-y]|=128*d},A={read:_,write:C};t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;return t.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=v(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=v(this.buf,this.pos)+4294967296*v(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=v(this.buf,this.pos)+4294967296*x(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=A.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=A.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,n,i=this.buf;return n=i[this.pos++],r=127&n,n<128?r:(n=i[this.pos++],r|=(127&n)<<7,n<128?r:(n=i[this.pos++],r|=(127&n)<<14,n<128?r:(n=i[this.pos++],r|=(127&n)<<21,n<128?r:(n=i[this.pos],r|=(15&n)<<28,e(r,t,this)))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=b(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=r(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=r(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(e){var r=7&e;if(r===t.Varint)for(;this.buf[this.pos++]>127;);else if(r===t.Bytes)this.pos=this.readVarint()+this.pos;else if(r===t.Fixed32)this.pos+=4;else{if(r!==t.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),g(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),g(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),g(this.buf,-1&t,this.pos),g(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),g(this.buf,-1&t,this.pos),g(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){if((t=+t||0)>268435455||t<0)return void i(t,this);this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=w(this.buf,t,this.pos);var r=this.pos-e;r>=128&&s(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),A.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),A.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&s(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,r,n){this.writeTag(e,t.Bytes),this.writeRawMessage(r,n)},writePackedVarint:function(t,e){this.writeMessage(t,u,e)},writePackedSVarint:function(t,e){this.writeMessage(t,l,e)},writePackedBoolean:function(t,e){this.writeMessage(t,f,e)},writePackedFloat:function(t,e){this.writeMessage(t,p,e)},writePackedDouble:function(t,e){this.writeMessage(t,c,e)},writePackedFixed32:function(t,e){this.writeMessage(t,h,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){this.writeMessage(t,d,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,m,e)},writeBytesField:function(e,r){this.writeTag(e,t.Bytes),this.writeBytes(r)},writeFixed32Field:function(e,r){this.writeTag(e,t.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(e,r){this.writeTag(e,t.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(e,r){this.writeTag(e,t.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(e,r){this.writeTag(e,t.Fixed64),this.writeSFixed64(r)},writeVarintField:function(e,r){this.writeTag(e,t.Varint),this.writeVarint(r)},writeSVarintField:function(e,r){this.writeTag(e,t.Varint),this.writeSVarint(r)},writeStringField:function(e,r){this.writeTag(e,t.Bytes),this.writeString(r)},writeFloatField:function(e,r){this.writeTag(e,t.Fixed32),this.writeFloat(r)},writeDoubleField:function(e,r){this.writeTag(e,t.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}},t}),define("MVT/DictionaryCoder",[],function(){"use strict";function t(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}}return t.prototype.encode=function(t){return this._stringToNumber[t]},t.prototype.decode=function(t){return this._numberToString[t]},t}),define("core/defined",[],function(){"use strict";function t(t){return void 0!==t&&null!==t}return t}),define("MVT/util/createLayout",[],function(){"use strict";function t(t,n){void 0===n&&(n=1);var i=0,o=0;return{members:t.map(function(t){var a=e(t.type),s=i=r(i,Math.max(n,a)),u=t.components||1;return o=Math.max(o,a),i+=a*u,{name:t.name,type:t.type,components:u,offset:s}}),size:r(i,Math.max(o,n)),alignment:n}}function e(t){return n[t].BYTES_PER_ELEMENT}function r(t,e){return Math.ceil(t/e)*e}var n={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};return t}),define("MVT/render/ImagePosition",[],function(){"use strict";var t=function(t,e){var r=e.pixelRatio,n=e.version,i=e.stretchX,o=e.stretchY,a=e.content;this.paddedRect=t,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n},e={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};return e.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},e.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},e.tlbr.get=function(){return this.tl.concat(this.br)},e.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(t.prototype,e),t}),define("MVT/util/RGBAImage",[],function(){"use strict";function t(t,e,r,n){var i=e.width,o=e.height;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==i*o*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(i*o*r);return t.width=i,t.height=o,t.data=n,t}function e(e,n,i){var o=n.width,a=n.height;if(o!==e.width||a!==e.height){var s=t({},{width:o,height:a},i);r(e,s,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,o),height:Math.min(e.height,a)},i),e.width=o,e.height=a,e.data=s.data}}function r(t,e,r,n,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,u=0;u<i.height;u++)for(var l=((r.y+u)*t.width+r.x)*o,p=((n.y+u)*e.width+n.x)*o,c=0;c<i.width*o;c++)s[p+c]=a[l+c];return e}var n=function(e,r){t(this,e,4,r)};return n.prototype.resize=function(t){e(this,t,4)},n.prototype.replace=function(t,e){e?this.data.set(t):t instanceof Uint8ClampedArray?this.data=new Uint8Array(t.buffer):this.data=t},n.prototype.clone=function(){return new n({width:this.width,height:this.height},new Uint8Array(this.data))},n.copy=function(t,e,n,i,o){r(t,e,n,i,o,4)},n}),define("ThirdParty/potpack",[],function(){function t(t){for(var e=0,r=0,n=0,i=t;n<i.length;n+=1){var o=i[n];e+=o.w*o.h,r=Math.max(r,o.w)}t.sort(function(t,e){return e.h-t.h});for(var a=Math.max(Math.ceil(Math.sqrt(e/.95)),r),s=[{x:0,y:0,w:a,h:1/0}],u=0,l=0,p=0,c=t;p<c.length;p+=1)for(var f=c[p],h=s.length-1;h>=0;h--){var y=s[h];if(!(f.w>y.w||f.h>y.h)){if(f.x=y.x,f.y=y.y,l=Math.max(l,f.y+f.h),u=Math.max(u,f.x+f.w),f.w===y.w&&f.h===y.h){var d=s.pop();h<s.length&&(s[h]=d)}else f.h===y.h?(y.x+=f.w,y.w-=f.w):f.w===y.w?(y.y+=f.h,y.h-=f.h):(s.push({x:y.x+f.w,y:y.y,w:y.w-f.w,h:f.h}),y.y+=f.h,y.h-=f.h);break}}return{w:u,h:l,fill:e/(u*l)||0}}return t}),define("MVT/render/image_atlas",["./ImagePosition","../util/RGBAImage","../../ThirdParty/potpack"],function(t,e,r){"use strict";var n=function(t,n){var i={},o={};this.haveRenderCallbacks=[];var a=[];this.addImages(t,i,a),this.addImages(n,o,a);var s=r(a),u=s.w,l=s.h,p=new e({width:u||1,height:l||1});for(var c in t){var f=t[c],h=i[c].paddedRect;e.copy(f.data,p,{x:0,y:0},{x:h.x+1,y:h.y+1},f.data)}for(var y in n){var d=n[y],m=o[y].paddedRect,v=m.x+1,g=m.y+1,x=d.data.width,b=d.data.height;e.copy(d.data,p,{x:0,y:0},{x:v,y:g},d.data),e.copy(d.data,p,{x:0,y:b-1},{x:v,y:g-1},{width:x,height:1}),e.copy(d.data,p,{x:0,y:0},{x:v,y:g+b},{width:x,height:1}),e.copy(d.data,p,{x:x-1,y:0},{x:v-1,y:g},{width:1,height:b}),e.copy(d.data,p,{x:0,y:0},{x:v+x,y:g},{width:1,height:b})}this.image=p,this.iconPositions=i,this.patternPositions=o};return n.prototype.addImages=function(e,r,n){for(var i in e){var o=e[i],a={x:0,y:0,w:o.data.width+2,h:o.data.height+2};n.push(a),r[i]=new t(a,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}},n.prototype.patchUpdatedImages=function(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var r in t.updatedImages)this.patchUpdatedImage(this.iconPositions[r],t.getImage(r),e),this.patchUpdatedImage(this.patternPositions[r],t.getImage(r),e)},n.prototype.patchUpdatedImage=function(t,e,r){if(t&&e&&t.version!==e.version){t.version=e.version;var n=t.tl,i=n[0],o=n[1];r.update(e.data,void 0,{x:i,y:o})}},n}),define("MVT/style-spec/csscolorparser",[],function(){"use strict";function t(t){return t=Math.round(t),t<0?0:t>255?255:t}function e(t){return t<0?0:t>1?1:t}function r(e){return t("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function n(t){return e("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function i(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}function o(e){var o=e.replace(/ /g,"").toLowerCase();if(o in a)return a[o].slice();if("#"===o[0]){if(4===o.length){var s=parseInt(o.substr(1),16);return s>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null}if(7===o.length){var s=parseInt(o.substr(1),16);return s>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null}return null}var u=o.indexOf("("),l=o.indexOf(")");if(-1!==u&&l+1===o.length){var p=o.substr(0,u),c=o.substr(u+1,l-(u+1)).split(","),f=1;switch(p){case"rgba":if(4!==c.length)return null;f=n(c.pop());case"rgb":return 3!==c.length?null:[r(c[0]),r(c[1]),r(c[2]),f];case"hsla":if(4!==c.length)return null;f=n(c.pop());case"hsl":if(3!==c.length)return null;var h=(parseFloat(c[0])%360+360)%360/360,y=n(c[1]),d=n(c[2]),m=d<=.5?d*(y+1):d+y-d*y,v=2*d-m;return[t(255*i(v,m,h+1/3)),t(255*i(v,m,h)),t(255*i(v,m,h-1/3)),f];default:return null}}return null}var a={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};return o}),define("MVT/style-spec/util/color",["../csscolorparser"],function(t){"use strict";var e=function(t,e,r,n){void 0===n&&(n=1),this.r=t,this.g=e,this.b=r,this.a=n};return e.parse=function(r){if(r){if(r instanceof e)return r;if("string"==typeof r){var n=t(r);if(n)return new e(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},e.prototype.toString=function(){var t=this.toArray(),e=t[0],r=t[1],n=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(r)+","+Math.round(n)+","+i+")"},e.prototype.toArray=function(){var t=this,e=t.r,r=t.g,n=t.b,i=t.a;return 0===i?[0,0,0,0]:[255*e/i,255*r/i,255*n/i,i]},e.black=new e(0,0,0,1),e.white=new e(1,1,1,1),e.transparent=new e(0,0,0,0),e.red=new e(1,0,0,1),e}),define("MVT/style-spec/expression/types",[],function(){"use strict";function t(e){if("array"===e.kind){var r=t(e.itemType);return"number"==typeof e.N?"array<"+r+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+r+">"}return e.kind}function e(r,n){if("error"===n.kind)return null;if("array"===r.kind){if("array"===n.kind&&(0===n.N&&"value"===n.itemType.kind||!e(r.itemType,n.itemType))&&("number"!=typeof r.N||r.N===n.N))return null}else{if(r.kind===n.kind)return null;if("value"===r.kind)for(var i=0,o=c;i<o.length;i+=1){var a=o[i];if(!e(a,n))return null}}return"Expected "+t(r)+" but found "+t(n)+" instead."}var r={kind:"null"},n={kind:"number"},i={kind:"string"},o={kind:"boolean"},a={kind:"color"},s={kind:"object"},u={kind:"value"},l={kind:"formatted"},p={kind:"resolvedImage"},c=[r,n,i,o,a,l,s,function(t,e){return{kind:"array",itemType:t,N:e}}(u),p];return e}),define("MVT/style-spec/expression/definitions/assertion",["../types"],function(t){"use strict";function e(t,e){return{kind:"array",itemType:t,N:e}}var r={kind:"number"},n={kind:"string"},i={kind:"boolean"},o={kind:"object"},a={kind:"value"},s={string:n,number:r,boolean:i,object:o},u=function(t,e){this.type=t,this.args=e};return u.parse=function(t,r){if(t.length<2)return r.error("Expected at least one argument.");var n,i=1,o=t[0];if("array"===o){var l;if(t.length>2){var p=t[1];if("string"!=typeof p||!(p in s)||"object"===p)return r.error('The item type argument of "array" must be one of string, number, boolean',1);l=s[p],i++}else l=a;var c;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);c=t[2],i++}n=e(l,c)}else assert_1(s[o],o),n=s[o];for(var f=[];i<t.length;i++){var h=r.parse(t[i],i,a);if(!h)return null;f.push(h)}return new u(n,f)},u.prototype.evaluate=function(e){for(var r=0;r<this.args.length;r++){var n=this.args[r].evaluate(e);if(!t(this.type,typeOf(n)))return n;if(r===this.args.length-1)throw new RuntimeError("Expected value to be of type "+toString(this.type)+", but found "+toString(typeOf(n))+" instead.")}return assert_1(!1),null},u.prototype.eachChild=function(t){this.args.forEach(t)},u.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},u.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);var n=t.N;("number"==typeof n||this.args.length>1)&&e.push(n)}}return e.concat(this.args.map(function(t){return t.serialize()}))},u}),define("MVT/style-spec/expression/definitions/at",["../types"],function(t){"use strict";function e(t,e){return{kind:"array",itemType:t,N:e}}var r={kind:"number"},n={kind:"value"},i=function(t,e,r){this.type=t,this.index=e,this.input=r};return i.parse=function(t,o){if(3!==t.length)return o.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var a=o.parse(t[1],1,r),s=o.parse(t[2],2,e(o.expectedType||n));if(!a||!s)return null;var u=s.type;return new i(u.itemType,a,s)},i.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new RuntimeError("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new RuntimeError("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new RuntimeError("Array index must be an integer, but found "+e+" instead.");return r[e]},i.prototype.eachChild=function(t){t(this.index),t(this.input)},i.prototype.possibleOutputs=function(){return[void 0]},i.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]},i}),define("MVT/style-spec/expression/definitions/case",["../types"],function(t){"use strict";var e={kind:"boolean"},r=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};return r.parse=function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return n.error("Expected an odd number of arguments.");var i;n.expectedType&&"value"!==n.expectedType.kind&&(i=n.expectedType);for(var o=[],a=1;a<t.length-1;a+=2){var s=n.parse(t[a],a,e);if(!s)return null;var u=n.parse(t[a+1],a+1,i);if(!u)return null;o.push([s,u]),i=i||u.type}var l=n.parse(t[t.length-1],t.length-1,i);return l?(assert_1(i),new r(i,o,l)):null},r.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},r.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t(i),t(o)}t(this.otherwise)},r.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.branches.map(function(t){t[0];return t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},r.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t},r}),define("MVT/style-spec/expression/types/resolved_image",[],function(){"use strict";var t=function(t){this.name=t.name,this.available=t.available};return t.prototype.toString=function(){return this.name},t.fromString=function(e){return new t({name:e,available:!1})},t.prototype.serialize=function(){return["image",this.name]},t}),define("MVT/style-spec/expression/definitions/coalesce",["../types","../types/resolved_image"],function(t,e){"use strict";var r={kind:"value"},n=function(t,e){this.type=t,this.args=e};return n.parse=function(e,i){if(e.length<2)return i.error("Expectected at least one argument.");var o=null,a=i.expectedType;a&&"value"!==a.kind&&(o=a);for(var s=[],u=0,l=e.slice(1);u<l.length;u+=1){var p=l[u],c=i.parse(p,1+s.length,o,void 0,{typeAnnotation:"omit"});if(!c)return null;o=o||c.type,s.push(c)}return assert_1(o),a&&s.some(function(e){return t(a,e.type)})?new n(r,s):new n(o,s)},n.prototype.evaluate=function(t){for(var r,n=null,i=0,o=0,a=this.args;o<a.length;o+=1){var s=a[o];if(i++,n=s.evaluate(t),n&&n instanceof e&&!n.available&&(r||(r=n.name),n=null,i===this.args.length&&(n=r)),null!==n)break}return n},n.prototype.eachChild=function(t){this.args.forEach(t)},n.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},n.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t},n}),define("MVT/style-spec/expression/definitions/coercion",["../types"],function(t){"use strict";var e={kind:"number"},r={kind:"string"},n={kind:"boolean"},i={kind:"color"},o={kind:"value"},a={"to-boolean":n,"to-color":i,"to-number":e,"to-string":r},s=function(t,e){this.type=t,this.args=e};return s.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if(assert_1(a[r],r),("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");for(var n=a[r],i=[],u=1;u<t.length;u++){var l=e.parse(t[u],u,o);if(!l)return null;i.push(l)}return new s(n,i)},s.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,r,n=0,i=this.args;n<i.length;n+=1){if(e=i[n].evaluate(t),r=null,e instanceof Color)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":validateRGBA(e[0],e[1],e[2],e[3])))return new Color(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new RuntimeError(r||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(t)))return 0;var l=Number(a);if(!isNaN(l))return l}throw new RuntimeError("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?Formatted.fromString(toString$1(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?ResolvedImage.fromString(toString$1(this.args[0].evaluate(t))):toString$1(this.args[0].evaluate(t))},s.prototype.eachChild=function(t){this.args.forEach(t)},s.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},s.prototype.serialize=function(){if("formatted"===this.type.kind)return new FormatExpression([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ImageExpression(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t},s}),define("MVT/style-spec/expression/types/collator",[],function(){"use strict";var t=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};return t.prototype.compare=function(t,e){return this.collator.compare(t,e)},t.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale},t}),define("MVT/style-spec/expression/definitions/collator",["../types","../types/collator"],function(t,e){"use strict";var r={kind:"string"},n={kind:"boolean"},i={kind:"collator"},o=function(t,e,r){this.type=i,this.locale=r,this.caseSensitive=t,
this.diacriticSensitive=e};return o.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");var a=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,n);if(!a)return null;var s=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,n);if(!s)return null;var u=null;return i.locale&&!(u=e.parse(i.locale,1,r))?null:new o(a,s,u)},o.prototype.evaluate=function(t){return new e(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},o.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},o.prototype.possibleOutputs=function(){return[void 0]},o.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]},o}),define("MVT/style-spec/expression/types/formatted_section",[],function(){"use strict";return function(t,e,r,n,i){this.text=t,this.image=e,this.scale=r,this.fontStack=n,this.textColor=i}}),define("MVT/style-spec/expression/types/formatted",["./formatted_section"],function(t){"use strict";var e=function(t){this.sections=t};return e.fromString=function(r){return new e([new t(r,null,null,null,null)])},e.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},e.factory=function(t){return t instanceof e?t:e.fromString(t)},e.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},e.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];if(n.image)t.push(["image",n.image.name]);else{t.push(n.text);var i={};n.fontStack&&(i["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(i["font-scale"]=n.scale),n.textColor&&(i["text-color"]=["rgba"].concat(n.textColor.toArray())),t.push(i)}}return t},e}),define("MVT/style-spec/expression/values",["../util/color","./types/collator","./types/formatted","./types/resolved_image"],function(t,e,r,n){"use strict";function i(t,e){return{kind:"array",itemType:t,N:e}}function o(){}var a={kind:"null"},s={kind:"number"},u={kind:"string"},l={kind:"boolean"},p={kind:"color"},c={kind:"object"},f={kind:"value"},h={kind:"collator"},y={kind:"formatted"},d={kind:"resolvedImage"};return o.validateRGBA=function(t,e,r,n){if(!("number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255)){return"Invalid rgba value ["+("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[t,e,r,n].join(", ")+"]: 'a' must be between 0 and 1."},o.isValue=function(i){if(null===i)return!0;if("string"==typeof i)return!0;if("boolean"==typeof i)return!0;if("number"==typeof i)return!0;if(i instanceof t)return!0;if(i instanceof e)return!0;if(i instanceof r)return!0;if(i instanceof n)return!0;if(Array.isArray(i)){for(var a=0,s=i;a<s.length;a+=1){var u=s[a];if(!o.isValue(u))return!1}return!0}if("object"==typeof i){for(var l in i)if(!o.isValue(i[l]))return!1;return!0}return!1},o.typeOf=function(m){if(null===m)return a;if("string"==typeof m)return u;if("boolean"==typeof m)return l;if("number"==typeof m)return s;if(m instanceof t)return p;if(m instanceof e)return h;if(m instanceof r)return y;if(m instanceof n)return d;if(Array.isArray(m)){for(var v,g=m.length,x=0,b=m;x<b.length;x+=1){var w=b[x],_=o.typeOf(w);if(v){if(v===_)continue;v=f;break}v=_}return i(v||f,g)}return assert_1("object"==typeof m),c},o.toString$1=function(e){var i=typeof e;return null===e?"":"string"===i||"number"===i||"boolean"===i?String(e):e instanceof t||e instanceof r||e instanceof n?e.toString():JSON.stringify(e)},o}),define("MVT/style-spec/expression/definitions/comparison",["./assertion","../values"],function(t,e){"use strict";function r(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function n(t,e,r){return e===r}function i(t,e,r){return e!==r}function o(t,e,r){return e<r}function a(t,e,r){return e>r}function s(t,e,r){return e<=r}function u(t,e,r){return e>=r}function l(t,e,r,n){return 0===n.compare(e,r)}function p(t,e,r,n){return!l(t,e,r,n)}function c(t,e,r,n){return n.compare(e,r)<0}function f(t,e,r,n){return n.compare(e,r)>0}function h(t,e,r,n){return n.compare(e,r)<=0}function y(t,e,r,n){return n.compare(e,r)>=0}function d(n,i,o){var a="=="!==n&&"!="!==n;return function(){function s(t,e,r){this.type=m,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return s.parse=function(e,n){if(3!==e.length&&4!==e.length)return n.error("Expected two or three arguments.");var i=e[0],o=n.parse(e[1],1,v);if(!o)return null;if(!r(i,o.type))return n.concat(1).error('"'+i+"\" comparisons are not supported for type '"+toString(o.type)+"'.");var u=n.parse(e[2],2,v);if(!u)return null;if(!r(i,u.type))return n.concat(2).error('"'+i+"\" comparisons are not supported for type '"+toString(u.type)+"'.");if(o.type.kind!==u.type.kind&&"value"!==o.type.kind&&"value"!==u.type.kind)return n.error("Cannot compare types '"+toString(o.type)+"' and '"+toString(u.type)+"'.");a&&("value"===o.type.kind&&"value"!==u.type.kind?o=new t(u.type,[o]):"value"!==o.type.kind&&"value"===u.type.kind&&(u=new t(o.type,[u])));var l=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==u.type.kind&&"value"!==o.type.kind&&"value"!==u.type.kind)return n.error("Cannot use collator to compare non-string types.");if(!(l=n.parse(e[3],3,g)))return null}return new s(o,u,l)},s.prototype.evaluate=function(t){var r=this.lhs.evaluate(t),s=this.rhs.evaluate(t);if(a&&this.hasUntypedArgument){var u=e.typeOf(r),l=e.typeOf(s);if(u.kind!==l.kind||"string"!==u.kind&&"number"!==u.kind)throw new RuntimeError('Expected arguments for "'+n+'" to be (string, string) or (number, number), but found ('+u.kind+", "+l.kind+") instead.")}if(this.collator&&!a&&this.hasUntypedArgument){var p=e.typeOf(r),c=e.typeOf(s);if("string"!==p.kind||"string"!==c.kind)return i(t,r,s)}return this.collator?o(t,r,s,this.collator.evaluate(t)):i(t,r,s)},s.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},s.prototype.possibleOutputs=function(){return[!0,!1]},s.prototype.serialize=function(){var t=[n];return this.eachChild(function(e){t.push(e.serialize())}),t},s}()}var m={kind:"boolean"},v={kind:"value"},g={kind:"collator"},x={};return x.Equals=d("==",n,l),x.NotEquals=d("!=",i,p),x.LessThan=d("<",o,c),x.GreaterThan=d(">",a,f),x.LessThanOrEqual=d("<=",s,h),x.GreaterThanOrEqual=d(">=",u,y),x}),define("MVT/style-spec/expression/definitions/format",["../types","../types/formatted","../types/formatted_section","../values"],function(t,e,r,n){"use strict";function i(t,e){return{kind:"array",itemType:t,N:e}}var o={kind:"number"},a={kind:"string"},s={kind:"color"},u={kind:"value"},l={kind:"formatted"},p={kind:"resolvedImage"},c=function(t){this.type=l,this.sections=t};return c.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[1];if(!Array.isArray(r)&&"object"==typeof r)return e.error("First argument must be an image or text section.");for(var n=[],l=!1,p=1;p<=t.length-1;++p){var f=t[p];if(l&&"object"==typeof f&&!Array.isArray(f)){l=!1;var h=null;if(f["font-scale"]&&!(h=e.parse(f["font-scale"],1,o)))return null;var y=null;if(f["text-font"]&&!(y=e.parse(f["text-font"],1,i(a))))return null;var d=null;if(f["text-color"]&&!(d=e.parse(f["text-color"],1,s)))return null;var m=n[n.length-1];m.scale=h,m.font=y,m.textColor=d}else{var v=e.parse(t[p],1,u);if(!v)return null;var g=v.type.kind;if("string"!==g&&"value"!==g&&"null"!==g&&"resolvedImage"!==g)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");l=!0,n.push({content:v,scale:null,font:null,textColor:null})}}return new c(n)},c.prototype.evaluate=function(t){var i=function(e){var i=e.content.evaluate(t);return n.typeOf(i)===p?new r("",i,null,null,null):new r(n.toString$1(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)};return new e(this.sections.map(i))},c.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor)}},c.prototype.possibleOutputs=function(){return[void 0]},c.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t.push(n.content.serialize());var i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),n.textColor&&(i["text-color"]=n.textColor.serialize()),t.push(i)}return t},c}),define("MVT/style-spec/expression/definitions/image",["../types/resolved_image"],function(t){"use strict";var e={kind:"string"},r={kind:"resolvedImage"},n=function(t){this.type=r,this.input=t};return n.parse=function(t,r){if(2!==t.length)return r.error("Expected two arguments.");var i=r.parse(t[1],1,e);return i?new n(i):r.error("No image name provided.")},n.prototype.evaluate=function(e){var r=this.input.evaluate(e),n=!1;return e.availableImages&&e.availableImages.indexOf(r)>-1&&(n=!0),new t({name:r,available:n})},n.prototype.eachChild=function(t){t(this.input)},n.prototype.possibleOutputs=function(){return[void 0]},n.prototype.serialize=function(){return["image",this.input.serialize()]},n}),define("MVT/style-spec/expression/definitions/interpolate",[],function(){"use strict";function t(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var e=function(t,e,r,n,i){this.type=t,this.operator=e,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],l=s[1];this.labels.push(u),this.outputs.push(l)}};return e.interpolationFactor=function(e,r,n,i){var o=0;if("exponential"===e.name)o=t(r,e.base,n,i);else if("linear"===e.name)o=t(r,1,n,i);else if("cubic-bezier"===e.name){var a=e.controlPoints,s=new unitbezier(a[0],a[1],a[2],a[3]);o=s.solve(t(r,1,n,i))}return o},e.parse=function(t,r){var n=t[0],i=t[1],o=t[2],a=t.slice(3);if(!Array.isArray(i)||0===i.length)return r.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var s=i[1];if("number"!=typeof s)return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:s}}else{if("cubic-bezier"!==i[0])return r.error("Unknown interpolation type "+String(i[0]),1,0);var u=i.slice(1);if(4!==u.length||u.some(function(t){return"number"!=typeof t||t<0||t>1}))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}if(t.length-1<4)return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(!(o=r.parse(o,2,NumberType)))return null;var l=[],p=null;"interpolate-hcl"===n||"interpolate-lab"===n?p=ColorType:r.expectedType&&"value"!==r.expectedType.kind&&(p=r.expectedType);for(var c=0;c<a.length;c+=2){var f=a[c],h=a[c+1],y=c+3,d=c+4;if("number"!=typeof f)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',y);if(l.length&&l[l.length-1][0]>=f)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',y);var m=r.parse(h,d,p);if(!m)return null;p=p||m.type,l.push([f,m])}return"number"===p.kind||"color"===p.kind||"array"===p.kind&&"number"===p.itemType.kind&&"number"==typeof p.N?new e(p,n,i,o,l):r.error("Type "+toString(p)+" is not interpolatable.")},e.prototype.evaluate=function(t){var r=this.labels,n=this.outputs;if(1===r.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=r[0])return n[0].evaluate(t);var o=r.length;if(i>=r[o-1])return n[o-1].evaluate(t);var a=findStopLessThanOrEqualTo(r,i),s=r[a],u=r[a+1],l=e.interpolationFactor(this.interpolation,i,s,u),p=n[a].evaluate(t),c=n[a+1].evaluate(t);return"interpolate"===this.operator?interpolate[this.type.kind.toLowerCase()](p,c,l):"interpolate-hcl"===this.operator?hcl.reverse(hcl.interpolate(hcl.forward(p),hcl.forward(c),l)):lab.reverse(lab.interpolate(lab.forward(p),lab.forward(c),l))},e.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},e.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}))},e.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e},e}),define("MVT/style-spec/expression/definitions/in",[],function(){"use strict";function t(t){return"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind}function e(t){return"boolean"==typeof t||"string"==typeof t||"number"==typeof t}function r(t){return Array.isArray(t)||"string"==typeof t}var n={kind:"boolean"},i={kind:"value"},o=function(t,e){this.type=n,this.needle=t,this.haystack=e};return o.parse=function(e,r){if(3!==e.length)return r.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var n=r.parse(e[1],1,i),a=r.parse(e[2],2,i);return n&&a?t(n.type)?new o(n,a):r.error("Expected first argument to be of type boolean, string, number or null, but found "+toString(n.type)+" instead"):null},o.prototype.evaluate=function(t){var n=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!n||!i)return!1;if(!e(n))throw new RuntimeError("Expected first argument to be of type boolean, string or number, but found "+toString(typeOf(n))+" instead.");if(!r(i))throw new RuntimeError("Expected second argument to be of type array or string, but found "+toString(typeOf(i))+" instead.");return i.indexOf(n)>=0},o.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},o.prototype.possibleOutputs=function(){return[!0,!1]},o.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]},o}),define("MVT/style-spec/expression/definitions/let",[],function(){"use strict";var t=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};return t.prototype.evaluate=function(t){return this.result.evaluate(t)},t.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1){t(r[e][1])}t(this.result)},t.parse=function(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var n=[],i=1;i<e.length-1;i+=2){var o=e[i];if("string"!=typeof o)return r.error("Expected string, but found "+typeof o+" instead.",i);if(/[^a-zA-Z0-9_]/.test(o))return r.error("Variable names must contain only alphanumeric characters or '_'.",i);var a=r.parse(e[i+1],i+1);if(!a)return null;n.push([o,a])}var s=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return s?new t(n,s):null},t.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},t.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t},t}),define("MVT/style-spec/expression/definitions/length",[],function(){"use strict";var t={kind:"number"},e=function(e){this.type=t,this.input=e};return e.parse=function(t,r){if(2!==t.length)return r.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=r.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?r.error("Expected argument of type string or array, but found "+toString(n.type)+" instead."):new e(n):null},e.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new RuntimeError("Expected value to be of type string or array, but found "+toString(typeOf(e))+" instead.")},e.prototype.eachChild=function(t){t(this.input)},e.prototype.possibleOutputs=function(){return[void 0]},e.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t},e}),define("MVT/style-spec/expression/definitions/literal",["../values","../types/formatted"],function(t,e){"use strict";var r=function(t,e){this.type=t,this.value=e};return r.parse=function(e,n){if(2!==e.length)return n.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!t.isValue(e[1]))return n.error("invalid value");var i=e[1],o=t.typeOf(i),a=n.expectedType;return"array"!==o.kind||0!==o.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(o=a),new r(o,i)},r.prototype.evaluate=function(){return this.value},r.prototype.eachChild=function(){},r.prototype.possibleOutputs=function(){return[this.value]},r.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Color?["rgba"].concat(this.value.toArray()):this.value instanceof e?this.value.serialize():(assert_1(null===this.value||"string"==typeof this.value||"number"==typeof this.value||"boolean"==typeof this.value),this.value)},r}),define("MVT/style-spec/expression/definitions/match",["../values"],function(t){"use strict";var e={kind:"value"},r=function(t,e,r,n,i,o){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o};return r.parse=function(n,i){if(n.length<5)return i.error("Expected at least 4 arguments, but found only "+(n.length-1)+".");if(n.length%2!=1)return i.error("Expected an even number of arguments.");var o,a;i.expectedType&&"value"!==i.expectedType.kind&&(a=i.expectedType);for(var s={},u=[],l=2;l<n.length-1;l+=2){var p=n[l],c=n[l+1];Array.isArray(p)||(p=[p]);var f=i.concat(l);if(0===p.length)return f.error("Expected at least one branch label.");for(var h=0,y=p;h<y.length;h+=1){var d=y[h];if("number"!=typeof d&&"string"!=typeof d)return f.error("Branch labels must be numbers or strings.");if("number"==typeof d&&Math.abs(d)>Number.MAX_SAFE_INTEGER)return f.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof d&&Math.floor(d)!==d)return f.error("Numeric branch labels must be integer values.");if(o){if(f.checkSubtype(o,t.typeOf(d)))return null}else o=t.typeOf(d);if(void 0!==s[String(d)])return f.error("Branch labels must be unique.");s[String(d)]=u.length}var m=i.parse(c,l,a);if(!m)return null;a=a||m.type,u.push(m)}var v=i.parse(n[1],1,e);if(!v)return null;var g=i.parse(n[n.length-1],n.length-1,a);return g?(assert_1(o&&a),"value"!==v.type.kind&&i.concat(1).checkSubtype(o,v.type)?null:new r(o,a,v,s,u,g)):null},r.prototype.evaluate=function(e){var r=this.input.evaluate(e);return(t.typeOf(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)},r.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},r.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},r.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),n=[],i={},o=0,a=r;o<a.length;o+=1){var s=a[o],u=i[this.cases[s]];void 0===u?(i[this.cases[s]]=n.length,n.push([this.cases[s],[s]])):n[u][1].push(s)}for(var l=function(e){return"number"===t.inputType.kind?Number(e):e},p=0,c=n;p<c.length;p+=1){var f=c[p],u=f[0],h=f[1];1===h.length?e.push(l(h[0])):e.push(h.map(l)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e},r}),define("MVT/style-spec/expression/definitions/number_format",[],function(){"use strict";var t={kind:"number"},e={kind:"string"},r=function(t,r,n,i,o){this.type=e,this.number=t,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=o};return r.parse=function(n,i){if(3!==n.length)return i.error("Expected two arguments.");var o=i.parse(n[1],1,t);if(!o)return null;var a=n[2];if("object"!=typeof a||Array.isArray(a))return i.error("NumberFormat options argument must be an object.");var s=null;if(a.locale&&!(s=i.parse(a.locale,1,e)))return null;var u=null;if(a.currency&&!(u=i.parse(a.currency,1,e)))return null;var l=null;if(a["min-fraction-digits"]&&!(l=i.parse(a["min-fraction-digits"],1,t)))return null;var p=null;return a["max-fraction-digits"]&&!(p=i.parse(a["max-fraction-digits"],1,t))?null:new r(o,s,u,l,p)},r.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},r.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},r.prototype.possibleOutputs=function(){return[void 0]},r.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]},r}),define("MVT/style-spec/expression/stops",[],function(){"use strict";function t(t,e){for(var r,n,i=t.length-1,o=0,a=i,s=0;o<=a;)if(s=Math.floor((o+a)/2),r=t[s],n=t[s+1],r<=e){if(s===i||e<n)return s;o=s+1}else{if(!(r>e))throw new RuntimeError("Input is not a number.");a=s-1}return 0}return t}),define("MVT/style-spec/expression/definitions/step",["../stops"],function(t){"use strict";var e={kind:"number"},r=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};return r.parse=function(t,n){if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");var i=n.parse(t[1],1,e);if(!i)return null;var o=[],a=null;n.expectedType&&"value"!==n.expectedType.kind&&(a=n.expectedType);for(var s=1;s<t.length;s+=2){var u=1===s?-1/0:t[s],l=t[s+1],p=s,c=s+1;if("number"!=typeof u)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(o.length&&o[o.length-1][0]>=u)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',p);var f=n.parse(l,c,a);if(!f)return null;a=a||f.type,o.push([u,f])}return new r(a,i,o)},r.prototype.evaluate=function(e){var r=this.labels,n=this.outputs;if(1===r.length)return n[0].evaluate(e);var i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);var o=r.length;return i>=r[o-1]?n[o-1].evaluate(e):n[t(r,i)].evaluate(e)},r.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},r.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}))},r.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t},r}),define("MVT/style-spec/expression/definitions/var",[],function(){"use strict";var t=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};return t.parse=function(e,r){if(2!==e.length||"string"!=typeof e[1])return r.error("'var' expression requires exactly one string literal argument.");var n=e[1];return r.scope.has(n)?new t(n,r.scope.get(n)):r.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},t.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},t.prototype.eachChild=function(){},t.prototype.possibleOutputs=function(){return[void 0]},t.prototype.serialize=function(){return["var",this.name]},t}),define("MVT/style-spec/expression/definitions/expressions",["./assertion","./at","./case","./coalesce","./coercion","./collator","./comparison","./format","./image","./interpolate","./in","./let","./length","./literal","./match","./number_format","./step","./var"],function(t,e,r,n,i,o,a,s,u,l,p,c,f,h,y,d,m,v){"use strict";return{"==":a.Equals,"!=":a.NotEquals,">":a.GreaterThan,"<":a.LessThan,">=":a.GreaterThanOrEqual,"<=":a.LessThanOrEqual,array:t,at:e,boolean:t,case:r,coalesce:n,collator:o,format:s,image:u,in:p,interpolate:l,"interpolate-hcl":l,"interpolate-lab":l,length:f,let:c,literal:h,match:y,number:t,"number-format":d,object:t,step:m,string:t,"to-boolean":i,"to-color":i,"to-number":i,"to-string":i,var:v}}),define("MVT/util/web_worker_transfer",["../render/image_atlas","../render/ImagePosition","../util/RGBAImage","../style-spec/util/color","../style-spec/expression/definitions/expressions","../style-spec/expression/types/formatted","../style-spec/expression/types/formatted_section","../style-spec/expression/types/resolved_image"],function(t,e,r,n,i,o,a,s){"use strict";function u(){}function l(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}var p={};u.register=function(t,e,r){void 0===r&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),p[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}},u.register("Object",Object),u.register("Color",n),u.register("ResolvedImage",s),u.register("ImageAtlas",t),u.register("ImagePosition",e),u.register("RGBAImage",r),u.register("Formatted",o),u.register("FormattedSection",a);for(var c in i)i[c]._classRegistryKey||u.register("Expression_"+c,i[c]);return u.serialize=function(t,e){if(null===t||void 0===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(l(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var n=[],i=0,o=t;i<o.length;i+=1){var a=o[i];n.push(u.serialize(a,e))}return n}if("object"==typeof t){var s=t.constructor,c=s._classRegistryKey;if(!c)throw new Error("can't serialize object of unregistered class");var f=s.serialize?s.serialize(t,e):{};if(!s.serialize){for(var h in t)if(t.hasOwnProperty(h)&&!(p[c].omit.indexOf(h)>=0)){var y=t[h];f[h]=p[c].shallow.indexOf(h)>=0?y:u.serialize(y,e)}t instanceof Error&&(f.message=t.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof t)},u.deserialize=function(t){if(null===t||void 0===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||l(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(u.deserialize);if("object"==typeof t){var e=t.$name||"Object",r=p[e],n=r.klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var i=Object.create(n.prototype),o=0,a=Object.keys(t);o<a.length;o+=1){var s=a[o];if("$name"!==s){var c=t[s];i[s]=p[e].shallow.indexOf(s)>=0?c:u.deserialize(c)}}return i}throw new Error("can't deserialize object of type "+typeof t)},u}),define("MVT/style/zoom_history",[],function(){"use strict";var t=function(){this.first=!0};return t.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))},t}),define("MVT/style/evaluation_parameters",["./zoom_history"],function(t){"use strict";var e=function(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new t,this.transition={})};return e.prototype.isSupportedScript=function(t){return!1},e.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},e.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}},e}),define("MVT/data/extent",[],function(){"use strict";return 8192}),define("MVT/data/load_geometry",["./extent"],function(t){"use strict";function e(t,e,r){return Math.min(r,Math.max(e,t))}function r(r){for(var i=t/r.extent,o=r.loadGeometry(),a=0;a<o.length;a++)for(var s=o[a],u=0;u<s.length;u++){var l=s[u];l.x=Math.round(l.x*i),l.y=t-Math.round(l.y*i),(l.x<n.min||l.x>n.max||l.y<n.min||l.y>n.max)&&(l.x=e(l.x,n.min,n.max),l.y=e(l.y,n.min,n.max))}return o}var n=function(t){return{min:-1*Math.pow(2,t-1),max:Math.pow(2,t-1)-1}}(15);return r}),define("MVT/data/segment",["../util/web_worker_transfer"],function(t){"use strict";var e=function(t){void 0===t&&(t=[]),this.segments=t};return e.prototype.prepareSegment=function(t,r,n,i){var o=this.segments[this.segments.length-1];return(!o||o.vertexLength+t>e.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i)&&(o={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(o.sortKey=i),this.segments.push(o)),o},e.prototype.get=function(){return this.segments},e.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var n in r.vaos)r.vaos[n].destroy()}},e.simpleSegment=function(t,r,n,i){return new e([{vertexOffset:t,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])},e.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,t.register("SegmentVector",e),e}),define("MVT/util/structArray",[],function(){"use strict";var t=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};return t.serialize=function(t,e){return t.isTransferred&&console.log("StructArray array.isTransferred."),t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},t.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},t.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},t.prototype.clear=function(){this.length=0},t.prototype.resize=function(t){this.reserve(t),this.length=t},t.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),
this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},t.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")},t}),define("MVT/data/StructArrayLayout2i4ub8",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,n,i,o)},e.prototype.emplace=function(t,e,r,n,i,o,a){var s=4*t,u=8*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.uint8[u+4]=n,this.uint8[u+5]=i,this.uint8[u+6]=o,this.uint8[u+7]=a,t},e}(t);return r.prototype.bytesPerElement=8,e.register("StructArrayLayout2i4ub8",r),r}),define("MVT/data/StructArrayLayout3ui6",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r)},e.prototype.emplace=function(t,e,r,n){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=r,this.uint16[i+2]=n,t},e}(t);return r.prototype.bytesPerElement=6,e.register("StructArrayLayout3ui6",r),r}),define("MVT/data/feature_position_map",["../util/web_worker_transfer"],function(t){"use strict";function e(t,n,i,o){if(!(i>=o)){for(var a=t[i+o>>1],s=i-1,u=o+1;;){do{s++}while(t[s]<a);do{u--}while(t[u]>a);if(s>=u)break;r(t,s,u),r(n,3*s,3*u),r(n,3*s+1,3*u+1),r(n,3*s+2,3*u+2)}e(t,n,i,u),e(t,n,u+1,o)}}function r(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}var n=function(){this.ids=[],this.positions=[],this.indexed=!1};return n.prototype.add=function(t,e,r,n){this.ids.push(t),this.positions.push(e,r,n)},n.prototype.getPositions=function(t){for(var e=0,r=this.ids.length-1;e<r;){var n=e+r>>1;this.ids[n]>=t?r=n:e=n+1}for(var i=[];this.ids[e]===t;){var o=this.positions[3*e],a=this.positions[3*e+1],s=this.positions[3*e+2];i.push({index:o,start:a,end:s}),e++}return i},n.serialize=function(t,r){var n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return e(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}},n.deserialize=function(t){var e=new n;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e},t.register("FeaturePositionMap",n),n}),define("MVT/style/possiblyEvaluatedPropertyValue",[],function(){"use strict";var t=function(t,e,r){this.property=t,this.value=e,this.parameters=r};return t.prototype.isConstant=function(){return"constant"===this.value.kind},t.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},t.prototype.evaluate=function(t,e,r){return this.property.evaluate(this.value,this.parameters,t,e,r)},t}),define("MVT/style-spec/util/properties",[],function(){"use strict";function t(){}return t.supportsPropertyExpression=function(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]},t.supportsZoomExpression=function(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1},t.supportsInterpolation=function(t){return!!t.expression&&t.expression.interpolated},t}),define("MVT/render/uniform_binding",["../style-spec/util/color"],function(t){"use strict";var e={},r=function(t,e){this.gl=t.gl,this.location=e};e.Uniform1i=function(t){function e(e,r){t.call(this,e,r),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(r),e.Uniform1f=function(t){function e(e,r){t.call(this,e,r),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(r),e.Uniform2f=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(r),e.Uniform3f=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(r),e.Uniform4f=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(r),e.UniformColor=function(e){function r(r,n){e.call(this,r,n),this.current=t.transparent}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},r}(r);var n=new Float32Array(16);return e.UniformMatrix4f=function(t){function e(e,r){t.call(this,e,r),this.current=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.gl.uniformMatrix4fv(this.location,!1,t)},e}(r),e}),define("MVT/data/StructArrayLayout8ui16",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,r,n,i,o,a,s)},e.prototype.emplace=function(t,e,r,n,i,o,a,s,u){var l=8*t;return this.uint16[l+0]=e,this.uint16[l+1]=r,this.uint16[l+2]=n,this.uint16[l+3]=i,this.uint16[l+4]=o,this.uint16[l+5]=a,this.uint16[l+6]=s,this.uint16[l+7]=u,t},e}(t);return r.prototype.bytesPerElement=16,e.register("StructArrayLayout8ui16",r),r}),define("MVT/data/StructArrayLayout2f8",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},e.prototype.emplace=function(t,e,r){var n=2*t;return this.float32[n+0]=e,this.float32[n+1]=r,t},e}(t);return r.prototype.bytesPerElement=8,e.register("StructArrayLayout2f8",r),r}),define("MVT/data/StructArrayLayout4f16",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,n)},e.prototype.emplace=function(t,e,r,n,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=i,t},e}(t);return r.prototype.bytesPerElement=16,e.register("StructArrayLayout4f16",r),r}),define("MVT/data/StructArrayLayout1f4",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){var r=1*t;return this.float32[r+0]=e,t},e}(t);return r.prototype.bytesPerElement=4,e.register("StructArrayLayout1f4",r),r}),define("MVT/data/program_configuration",["../util/web_worker_transfer","./feature_position_map","../style/possiblyEvaluatedPropertyValue","../style-spec/util/properties","../render/uniform_binding","./StructArrayLayout8ui16","./StructArrayLayout2f8","./StructArrayLayout4f16","./StructArrayLayout1f4"],function(t,e,r,n,i,o,a,s,u){"use strict";function l(t,e,r){return Math.min(r,Math.max(e,t))}function p(t,e){return t=l(Math.floor(t),0,255),e=l(Math.floor(e),0,255),256*t+e}function c(t){return[p(255*t.r,255*t.g),p(255*t.b,255*t.a)]}function f(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function h(t){return{"line-pattern":{source:o,composite:o},"fill-pattern":{source:o,composite:o},"fill-extrusion-pattern":{source:o,composite:o}}[t]}function y(t,e,r){var n={color:{source:a,composite:s},number:{source:u,composite:a}},i=h(t);return i&&i[r]||n[e][r]}var d=function(t,e,r){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=r,this.maxValue=-1/0};d.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},d.prototype.setConstantPatternPositions=function(){},d.prototype.populatePaintArray=function(){},d.prototype.updatePaintArray=function(){},d.prototype.upload=function(){},d.prototype.destroy=function(){},d.prototype.setUniforms=function(t,e,r,n){e.set(n.constantOr(this.value))},d.prototype.getBinding=function(t,e){return"color"===this.type?new i.UniformColor(t,e):new i.Uniform1f(t,e)},d.serialize=function(e){var r=e.value,n=e.names,i=e.type;return{value:t.serialize(r),names:n,type:i}},d.deserialize=function(e){var r=e.value,n=e.names,i=e.type;return new d(t.deserialize(r),n,i)};var m=function(t,e,r){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=r,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};m.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},m.prototype.populatePaintArray=function(){},m.prototype.updatePaintArray=function(){},m.prototype.upload=function(){},m.prototype.destroy=function(){},m.prototype.setConstantPatternPositions=function(t,e){this.patternPositions.patternTo=t.tlbr,this.patternPositions.patternFrom=e.tlbr},m.prototype.setUniforms=function(t,e,r,n,i){var o=this.patternPositions;"u_pattern_to"===i&&o.patternTo&&e.set(o.patternTo),"u_pattern_from"===i&&o.patternFrom&&e.set(o.patternFrom)},m.prototype.getBinding=function(t,e){return new i.Uniform4f(t,e)};var v=function(t,e,r,n){this.expression=t,this.names=e,this.type=r,this.uniformNames=this.names.map(function(t){return"a_"+t}),this.maxValue=-1/0,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?2:1,offset:0}}),this.paintVertexArray=new n};v.prototype.defines=function(){return[]},v.prototype.setConstantPatternPositions=function(){},v.prototype.populatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=i.length;i.reserve(t);var a=this.expression.evaluate(new EvaluationParameters(0),e,{},[],n);if("color"===this.type)for(var s=c(a),u=o;u<t;u++)i.emplaceBack(s[0],s[1]);else{for(var l=o;l<t;l++)i.emplaceBack(a);this.maxValue=Math.max(this.maxValue,a)}},v.prototype.updatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:0},r,n);if("color"===this.type)for(var a=c(o),s=t;s<e;s++)i.emplace(s,a[0],a[1]);else{for(var u=t;u<e;u++)i.emplace(u,o);this.maxValue=Math.max(this.maxValue,o)}},v.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},v.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},v.prototype.setUniforms=function(t,e){e.set(0)},v.prototype.getBinding=function(t,e){return new i.Uniform1f(t,e)};var g=function(t,e,r,n,i,o){this.expression=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t+"_t"}),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=-1/0;var a=o;this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?4:2,offset:0}}),this.paintVertexArray=new a};g.prototype.defines=function(){return[]},g.prototype.setConstantPatternPositions=function(){},g.prototype.populatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=i.length;i.reserve(t);var a=this.expression.evaluate(new EvaluationParameters(this.zoom),e,{},[],n),s=this.expression.evaluate(new EvaluationParameters(this.zoom+1),e,{},[],n);if("color"===this.type)for(var u=c(a),l=c(s),p=o;p<t;p++)i.emplaceBack(u[0],u[1],l[0],l[1]);else{for(var f=o;f<t;f++)i.emplaceBack(a,s);this.maxValue=Math.max(this.maxValue,a,s)}},g.prototype.updatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},r,n),a=this.expression.evaluate({zoom:this.zoom+1},r,n);if("color"===this.type)for(var s=c(o),u=c(a),l=t;l<e;l++)i.emplace(l,s[0],s[1],u[0],u[1]);else{for(var p=t;p<e;p++)i.emplace(p,o,a);this.maxValue=Math.max(this.maxValue,o,a)}},g.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},g.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},g.prototype.interpolationFactor=function(t){return this.useIntegerZoom&&(t=Math.floor(t)),l(this.expression.interpolationFactor(t,this.zoom,this.zoom+1),0,1)},g.prototype.setUniforms=function(t,e,r){e.set(this.interpolationFactor(r.zoom))},g.prototype.getBinding=function(t,e){return new i.Uniform1f(t,e)};var x=function(t,e,r,n,i,o,a){this.expression=t,this.names=e,this.type=r,this.uniformNames=this.names.map(function(t){return"u_"+t+"_t"}),this.useIntegerZoom=n,this.zoom=i,this.maxValue=-1/0,this.layerId=a,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o};x.prototype.defines=function(){return[]},x.prototype.setConstantPatternPositions=function(){},x.prototype.populatePaintArray=function(t,e,r){var n=this.zoomInPaintVertexArray,i=this.zoomOutPaintVertexArray,o=this,a=o.layerId,s=n.length;if(n.reserve(t),i.reserve(t),r&&e.patterns&&e.patterns[a]){var u=e.patterns[a],l=u.min,p=u.mid,c=u.max,f=r[l],h=r[p],y=r[c];if(!f||!h||!y)return;for(var d=s;d<t;d++)n.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1]),i.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1])}},x.prototype.updatePaintArray=function(t,e,r,n,i){var o=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,s=this,u=s.layerId;if(i&&r.patterns&&r.patterns[u]){var l=r.patterns[u],p=l.min,c=l.mid,f=l.max,h=i[p],y=i[c],d=i[f];if(!h||!y||!d)return;for(var m=t;m<e;m++)o.emplace(m,y.tl[0],y.tl[1],y.br[0],y.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1]),a.emplace(m,y.tl[0],y.tl[1],y.br[0],y.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}},x.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},x.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},x.prototype.setUniforms=function(t,e){e.set(0)},x.prototype.getBinding=function(t,e){return new Uniform1f(t,e)};var b=function(){this.binders={},this.cacheKey="",this._buffers=[]};return b.createDynamic=function(t,e,i){var o=new b,a=[];for(var s in t.paint._values)if(i(s)){var u=t.paint.get(s);if(u instanceof r&&n.supportsPropertyExpression(u.property.specification)){var l=f(s,t.type),p=u.property.specification.type,c=u.property.useIntegerZoom,h="cross-faded"===u.property.specification["property-type"]||"cross-faded-data-driven"===u.property.specification["property-type"];if(h)if("constant"===u.value.kind)o.binders[s]=new m(u.value.value,l,p),a.push("/u_"+s);else{var w=y(s,p,"source");o.binders[s]=new x(u.value,l,p,c,e,w,t.id),a.push("/a_"+s)}else if("constant"===u.value.kind)o.binders[s]=new d(u.value.value,l,p),a.push("/u_"+s);else if("source"===u.value.kind){var _=y(s,p,"source");o.binders[s]=new v(u.value,l,p,_),a.push("/a_"+s)}else{var C=y(s,p,"composite");o.binders[s]=new g(u.value,l,p,c,e,C),a.push("/z_"+s)}}}return o.cacheKey=a.sort().join(""),o},b.prototype.populatePaintArrays=function(t,e,r,n,i){for(var o in this.binders){this.binders[o].populatePaintArray(t,e,n,i)}},b.prototype.setConstantPatternPositions=function(t,e){for(var r in this.binders){this.binders[r].setConstantPatternPositions(t,e)}},b.prototype.updatePaintArrays=function(t,e,r,n,i){var o=!1;for(var a in t)for(var s=e.getPositions(+a),u=0,l=s;u<l.length;u+=1){var p=l[u],c=r.feature(p.index);for(var f in this.binders){var h=this.binders[f];if(!(h instanceof d||h instanceof m)&&!0===h.expression.isStateDependent){var y=n.paint.get(f);h.expression=y.value,h.updatePaintArray(p.start,p.end,c,t[a],i),o=!0}}}return o},b.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},b.prototype.getPaintVertexBuffers=function(){return this._buffers},b.prototype.getUniforms=function(t,e){var r=[];for(var n in this.binders)for(var i=this.binders[n],o=0,a=i.uniformNames;o<a.length;o+=1){var s=a[o];if(e[s]){var u=i.getBinding(t,e[s]);r.push({name:s,property:n,binding:u})}}return r},b.prototype.setUniforms=function(t,e,r,n){for(var i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.name,u=a.property,l=a.binding;this.binders[u].setUniforms(t,l,n,r.get(u),s)}},b.prototype.updatePatternPaintBuffers=function(t){var e=[];for(var r in this.binders){var n=this.binders[r];if(n instanceof x){var i=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&e.push(i)}else(n instanceof v||n instanceof g)&&n.paintVertexBuffer&&e.push(n.paintVertexBuffer)}this._buffers=e},b.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var r=[];for(var n in this.binders){var i=this.binders[n];(i instanceof v||i instanceof g)&&i.paintVertexBuffer&&r.push(i.paintVertexBuffer)}this._buffers=r},b.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()},t.register("ConstantBinder",d),t.register("CrossFadedConstantBinder",m),t.register("SourceExpressionBinder",v),t.register("CrossFadedCompositeBinder",x),t.register("CompositeExpressionBinder",g),t.register("ProgramConfiguration",b,{omit:["_buffers"]}),b}),define("MVT/data/programConfigurationSet",["../util/web_worker_transfer","./feature_position_map","./program_configuration"],function(t,e,r){"use strict";var n=function(t,n,i,o){void 0===o&&(o=function(){return!0}),this.programConfigurations={};for(var a=0,s=n;a<s.length;a+=1){var u=s[a];this.programConfigurations[u.id]=r.createDynamic(u,i,o),this.programConfigurations[u.id].layoutAttributes=t}this.needsUpload=!1,this._featureMap=new e,this._bufferOffset=0};return n.prototype.populatePaintArrays=function(t,e,r,n,i){for(var o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(t,e,r,n,i);void 0!==e.id&&this._featureMap.add(+e.id,r,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},n.prototype.updatePaintArrays=function(t,e,r,n){for(var i=0,o=r;i<o.length;i+=1){var a=o[i];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,n)||this.needsUpload}},n.prototype.get=function(t){return this.programConfigurations[t]},n.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},n.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},t.register("ProgramConfigurationSet",n),n}),define("MVT/data/bucket/addPatternDependencies",[],function(){"use strict";function t(t,e,r,n,i){for(var o=i.patternDependencies,a=0,s=e;a<s.length;a+=1){var u=s[a],l=u.paint.get(t+"-pattern"),p=l.value;if("constant"!==p.kind){var c=p.evaluate({zoom:n-1},r,{},i.availableImages),f=p.evaluate({zoom:n},r,{},i.availableImages),h=p.evaluate({zoom:n+1},r,{},i.availableImages);c=c&&c.name?c.name:c,f=f&&f.name?f.name:f,h=h&&h.name?h.name:h,o[c]=!0,o[f]=!0,o[h]=!0,r.patterns[u.id]={min:c,mid:f,max:h}}}return r}return t}),define("MVT/data/bucket/hasPattern",[],function(){"use strict";function t(t,e,r){for(var n=r.patternDependencies,i=!1,o=0,a=e;o<a.length;o+=1){var s=a[o],u=s.paint.get(t+"-pattern");u.isConstant()||(i=!0);var l=u.constantOr(null);l&&(i=!0,n[l.to]=!0,n[l.from]=!0)}return i}return t}),define("MVT/data/bucket/line_bucket",["../../../core/defined","../../util/createLayout","../../util/web_worker_transfer","../../style/evaluation_parameters","../load_geometry","../segment","../StructArrayLayout2i4ub8","../StructArrayLayout3ui6","../programConfigurationSet","./addPatternDependencies","./hasPattern","../extent"],function(t,e,r,n,i,o,a,s,u,l,p,c){"use strict";var f=["Unknown","Point","LineString","Polygon"],h=e([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),y=h.members,d=(h.size,h.alignment,Math.cos(Math.PI/180*37.5)),m=Math.pow(2,14)/.5,v=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new a,this.indexArray=new s,this.programConfigurations=new u(y,t.layers,t.zoom),this.segments=new o,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};return v.prototype.populate=function(t,e){this.hasPattern=!1;for(var r=this.layers[0].layout.get("line-sort-key"),o=[],a=0,s=t;a<s.length;a+=1){var u=s[a],p=u.feature,c=u.index,f=u.sourceLayerIndex;if(this.layers[0]._featureFilter(new n(0),p)){var h=i(p),y=r?r.evaluate(p,{}):void 0,d={id:p.id,properties:p.properties,type:p.type,sourceLayerIndex:f,index:c,geometry:h,patterns:{},sortKey:y};o.push(d)}}r&&o.sort(function(t,e){return t.sortKey-e.sortKey});for(var m=0,v=o;m<v.length;m+=1){var g=v[m],x=g,b=x.geometry,w=x.index,_=x.sourceLayerIndex;if(this.hasPattern){var C=l("line",this.layers,g,this.zoom,e);this.patternFeatures.push(C)}else this.addFeature(g,b,w,{});var A=t[w].feature;e.featureIndex.insert(A,b,w,_,this.index)}},v.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},v.prototype.addFeatures=function(t,e){for(var r=0,n=this.patternFeatures;r<n.length;r+=1){var i=n[r];this.addFeature(i,i.geometry,i.index,e)}},v.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},v.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},v.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,y),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},v.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},v.prototype.clear=function(){t(this.layoutVertexArray)&&(this.layoutVertexArray=null),t(this.indexArray)&&(this.indexArray=null)},v.prototype.addFeature=function(t,e,r,n){for(var i=this.layers[0].layout,o=i.get("line-join").evaluate(t,{}),a=i.get("line-cap"),s=i.get("line-miter-limit"),u=i.get("line-round-limit"),l=0,p=e;l<p.length;l+=1){var c=p[l];this.addLine(c,t,o,a,s,u,r,n)}},v.prototype.addLine=function(t,e,r,n,i,o,a,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var u=0;u<t.length-1;u++)this.totalDistance+=t[u].dist(t[u+1])}for(var l="Polygon"===f[e.type],p=t.length;p>=2&&t[p-1].equals(t[p-2]);)p--;for(var h=0;h<p-1&&t[h].equals(t[h+1]);)h++;if(!(p<(l?3:2))){"bevel"===r&&(i=1.05);var y,m=this.overscaling<=16?15*c/(512*this.overscaling):0,v=this.segments.prepareSegment(10*p,this.layoutVertexArray,this.indexArray),g=void 0,x=void 0,b=void 0,w=void 0;this.e1=this.e2=-1,l&&(y=t[p-2],w=t[h].sub(y)._unit()._perp());for(var _=h;_<p;_++)if(!(x=l&&_===p-1?t[h+1]:t[_+1])||!t[_].equals(x)){w&&(b=w),y&&(g=y),y=t[_],w=x?x.sub(y)._unit()._perp():b,b=b||w;var C=b.add(w);0===C.x&&0===C.y||C._unit();var A=b.x*w.x+b.y*w.y,S=C.x*w.x+C.y*w.y,E=0!==S?1/S:1/0,k=2*Math.sqrt(2-2*S),I=S<d&&g&&x,F=b.x*w.y-b.y*w.x>0;if(I&&_>h){var V=y.dist(g);if(V>2*m){var M=y.sub(y.sub(g)._mult(m/V)._round());this.updateDistance(g,M),this.addCurrentVertex(M,b,0,0,v),g=M}}var P=g&&x,T=P?r:l?"butt":n;if(P&&"round"===T&&(E<o?T="miter":E<=2&&(T="fakeround")),"miter"===T&&E>i&&(T="bevel"),"bevel"===T&&(E>2&&(T="flipbevel"),E<i&&(T="miter")),g&&this.updateDistance(g,y),"miter"===T)C._mult(E),this.addCurrentVertex(y,C,0,0,v);else if("flipbevel"===T){if(E>100)C=w.mult(-1);else{var z=E*b.add(w).mag()/b.sub(w).mag();C._perp()._mult(z*(F?-1:1))}this.addCurrentVertex(y,C,0,0,v),this.addCurrentVertex(y,C.mult(-1),0,0,v)}else if("bevel"===T||"fakeround"===T){var B=-Math.sqrt(E*E-1),O=F?B:0,D=F?0:B;if(g&&this.addCurrentVertex(y,b,O,D,v),"fakeround"===T)for(var L=Math.round(180*k/Math.PI/20),R=1;R<L;R++){var q=R/L;if(.5!==q){var U=q-.5,N=1.0904+A*(A*(3.55645-1.43519*A)-3.2452),j=.848013+A*(.215638*A-1.06021);q+=q*U*(q-1)*(N*U*U+j)}var G=w.sub(b)._mult(q)._add(b)._unit()._mult(F?-1:1);this.addHalfVertex(y,G.x,G.y,!1,F,0,v)}x&&this.addCurrentVertex(y,w,-O,-D,v)}else if("butt"===T)this.addCurrentVertex(y,C,0,0,v);else if("square"===T){var K=g?1:-1;this.addCurrentVertex(y,C,K,K,v)}else"round"===T&&(g&&(this.addCurrentVertex(y,b,0,0,v),this.addCurrentVertex(y,b,1,1,v,!0)),x&&(this.addCurrentVertex(y,w,-1,-1,v,!0),this.addCurrentVertex(y,w,0,0,v)));if(I&&_<p-1){var H=y.dist(x);if(H>2*m){var Y=y.add(x.sub(y)._mult(m/H)._round());this.updateDistance(y,Y),this.addCurrentVertex(Y,w,0,0,v),y=Y}}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,s)}},v.prototype.addCurrentVertex=function(t,e,r,n,i,o){void 0===o&&(o=!1);var a=e.x+e.y*r,s=e.y-e.x*r,u=-e.x+e.y*n,l=-e.y-e.x*n;this.addHalfVertex(t,a,s,o,!1,r,i),this.addHalfVertex(t,u,l,o,!0,-n,i),this.distance>m/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,r,n,i,o))},v.prototype.addHalfVertex=function(t,e,r,n,i,o,a){var s=t.x,u=t.y,l=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((s<<1)+(n?1:0),(u<<1)+(i?1:0),Math.round(63*e)+128,Math.round(63*r)+128,1+(0===o?0:o<0?-1:1)|(63&l)<<2,l>>6);var p=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),a.primitiveLength++),i?this.e2=p:this.e1=p},v.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(m-1):this.distance},r.register("LineBucket",v,{omit:["layers","patternFeatures"]}),v}),define("ThirdParty/quickselect",[],function(){"use strict";function t(t,r,i,o,a){e(t,r,i||0,o||t.length-1,a||n)}function e(t,n,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=n-i+1,l=Math.log(s),p=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*p*(s-p)/s)*(u-s/2<0?-1:1);e(t,n,Math.max(i,Math.floor(n-u*p/s+c)),Math.min(o,Math.floor(n+(s-u)*p/s+c)),a)}var f=t[n],h=i,y=o;for(r(t,i,n),a(t[o],f)>0&&r(t,i,o);h<y;){for(r(t,h,y),h++,y--;a(t[h],f)<0;)h++;for(;a(t[y],f)>0;)y--}0===a(t[i],f)?r(t,i,y):(y++,r(t,y,o)),y<=n&&(i=y+1),n<=y&&(o=y-1)}}function r(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function n(t,e){return t<e?-1:t>e?1:0}return t}),define("MVT/util/classify_rings",["../../ThirdParty/quickselect"],function(t){"use strict";function e(t){for(var e=0,r=0,n=t.length,i=n-1,o=void 0,a=void 0;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}function r(r,i){var o=r.length;if(o<=1)return[r];for(var a,s,u=[],l=0;l<o;l++){var p=e(r[l]);0!==p&&(r[l].area=Math.abs(p),void 0===s&&(s=p<0),s===p<0?(a&&u.push(a),a=[r[l]]):a.push(r[l]))}if(a&&u.push(a),i>1)for(var c=0;c<u.length;c++)u[c].length<=i||(t(u[c],i,1,u[c].length-1,n),u[c]=u[c].slice(0,i));return u}function n(t,e){return e.area-t.area}return r}),define("ThirdParty/earcut-2.1.1",[],function(){"use strict";function t(t,r,i){i=i||2;var o=r&&r.length,a=o?r[0]*i:t.length,s=e(t,0,a,i,!0),l=[];if(!s)return l;var p,c,f,h,y,d,m;if(o&&(s=u(t,r,s,i)),t.length>80*i){p=f=t[0],c=h=t[1];for(var v=i;v<a;v+=i)y=t[v],d=t[v+1],y<p&&(p=y),d<c&&(c=d),y>f&&(f=y),d>h&&(h=d);m=Math.max(f-p,h-c)}return n(s,l,i,p,c,m),l}function e(t,e,r,n,i){var o,a;if(i===I(t,e,r,n)>0)for(o=e;o<r;o+=n)a=S(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=S(o,t[o],t[o+1],a);return a&&x(a,a.next)&&(E(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!x(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(E(n),(n=e=n.prev)===n.next)return null;r=!0}}while(r||n!==e);return e}function n(t,e,u,l,p,c,h){if(t){!h&&c&&f(t,l,p,c);for(var y,d,m=t;t.prev!==t.next;)if(y=t.prev,d=t.next,c?o(t,l,p,c):i(t))e.push(y.i/u),e.push(t.i/u),e.push(d.i/u),E(t),t=d.next,m=d.next;else if((t=d)===m){h?1===h?(t=a(t,e,u),n(t,e,u,l,p,c,2)):2===h&&s(t,e,u,l,p,c):n(r(t),e,u,l,p,c,1);break}}}function i(t){var e=t.prev,r=t,n=t.next;if(g(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(m(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function o(t,e,r,n){var i=t.prev,o=t,a=t.next;if(g(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,p=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,c=y(s,u,e,r,n),f=y(l,p,e,r,n),h=t.nextZ;h&&h.z<=f;){
if(h!==t.prev&&h!==t.next&&m(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&g(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(h=t.prevZ;h&&h.z>=c;){if(h!==t.prev&&h!==t.next&&m(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&g(h.prev,h,h.next)>=0)return!1;h=h.prevZ}return!0}function a(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!x(i,o)&&b(i,n,n.next,o)&&_(i,o)&&_(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),E(n),E(n.next),n=t=o),n=n.next}while(n!==t);return n}function s(t,e,i,o,a,s){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&v(u,l)){var p=A(u,l);return u=r(u,u.next),p=r(p,p.next),n(u,e,i,o,a,s),void n(p,e,i,o,a,s)}l=l.next}u=u.next}while(u!==t)}function u(t,n,i,o){var a,s,u,c,f,h=[];for(a=0,s=n.length;a<s;a++)u=n[a]*o,c=a<s-1?n[a+1]*o:t.length,f=e(t,u,c,o,!1),f===f.next&&(f.steiner=!0),h.push(d(f));for(h.sort(l),a=0;a<h.length;a++)p(h[a],i),i=r(i,i.next);return i}function l(t,e){return t.x-e.x}function p(t,e){if(e=c(t,e)){var n=A(e,t);r(n,n.next)}}function c(t,e){var r,n=e,i=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===a)return r.prev;var u,l=r,p=r.x,c=r.y,f=1/0;for(n=r.next;n!==l;)i>=n.x&&n.x>=p&&m(o<c?i:a,o,p,c,o<c?a:i,o,n.x,n.y)&&((u=Math.abs(o-n.y)/(i-n.x))<f||u===f&&n.x>r.x)&&_(n,t)&&(r=n,f=u),n=n.next;return r}function f(t,e,r,n){var i=t;do{null===i.z&&(i.z=y(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,h(i)}function h(t){var e,r,n,i,o,a,s,u,l=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,s=0,e=0;e<l&&(s++,n=n.nextZ);e++);for(u=l;s>0||u>0&&n;)0===s?(i=n,n=n.nextZ,u--):0!==u&&n?r.z<=n.z?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--):(i=r,r=r.nextZ,s--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,l*=2}while(a>1);return t}function y(t,e,r,n,i){return t=32767*(t-r)/i,e=32767*(e-n)/i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function d(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function m(t,e,r,n,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(r-a)*(e-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!w(t,e)&&_(t,e)&&_(e,t)&&C(t,e)}function g(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,r,n){return!!(x(t,e)&&x(r,n)||x(t,n)&&x(r,e))||g(t,e,r)>0!=g(t,e,n)>0&&g(r,n,t)>0!=g(r,n,e)>0}function w(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&b(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function _(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function C(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}function A(t,e){var r=new k(t.i,t.x,t.y),n=new k(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function S(t,e,r,n){var i=new k(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}return t.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(I(t,0,o,r));if(i)for(var s=0,u=e.length;s<u;s++){var l=e[s]*r,p=s<u-1?e[s+1]*r:t.length;a-=Math.abs(I(t,l,p,r))}var c=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,h=n[s+1]*r,y=n[s+2]*r;c+=Math.abs((t[f]-t[y])*(t[h+1]-t[f+1])-(t[f]-t[h])*(t[y+1]-t[f+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},t.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r},t}),define("MVT/data/StructArrayLayout2i4",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},e.prototype.emplace=function(t,e,r){var n=2*t;return this.int16[n+0]=e,this.int16[n+1]=r,t},e}(t);return r.prototype.bytesPerElement=4,e.register("StructArrayLayout2i4",r),r}),define("MVT/data/StructArrayLayout2ui4",["../util/structArray","../util/web_worker_transfer"],function(t,e){"use strict";var r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},e.prototype.emplace=function(t,e,r){var n=2*t;return this.uint16[n+0]=e,this.uint16[n+1]=r,t},e}(t);return r.prototype.bytesPerElement=4,e.register("StructArrayLayout2ui4",r),r}),define("MVT/data/bucket/fill_bucket",["../../../core/defined","../../util/classify_rings","../../util/createLayout","../../util/web_worker_transfer","../../style/evaluation_parameters","../../../ThirdParty/earcut-2.1.1","../load_geometry","../segment","../StructArrayLayout2i4","../StructArrayLayout2ui4","../StructArrayLayout3ui6","../programConfigurationSet","./addPatternDependencies","./hasPattern"],function(t,e,r,n,i,o,a,s,u,l,p,c,f,h){"use strict";var y=r([{name:"a_pos",components:2,type:"Int16"}],4),d=y.members,m=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new u,this.indexArray=new p,this.indexArray2=new l,this.programConfigurations=new c(d,t.layers,t.zoom),this.segments=new s,this.segments2=new s,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};return m.prototype.populate=function(t,e){this.hasPattern=h("fill",this.layers,e);for(var r=null,n=[],o=0,s=t;o<s.length;o+=1){var u=s[o],l=u.feature,p=u.index,c=u.sourceLayerIndex;if(this.layers[0]._featureFilter(new i(0),l)){var y=a(l),d=r?r.evaluate(l,{},e.availableImages):void 0,m={id:l.id,properties:l.properties,type:l.type,sourceLayerIndex:c,index:p,geometry:y,patterns:{},sortKey:d};n.push(m)}}r&&n.sort(function(t,e){return t.sortKey-e.sortKey});for(var v=0,g=n;v<g.length;v+=1){var x=g[v],b=x,w=b.geometry,_=b.index,C=b.sourceLayerIndex;if(this.hasPattern){var A=f("fill",this.layers,x,this.zoom,e);this.patternFeatures.push(A)}else this.addFeature(x,w,_,{});var S=t[_].feature;e.featureIndex.insert(S,w,_,C,this.index)}},m.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},m.prototype.addFeatures=function(t,e){for(var r=0,n=this.patternFeatures;r<n.length;r+=1){var i=n[r];this.addFeature(i,i.geometry,i.index,e)}},m.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},m.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},m.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,d),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},m.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},m.prototype.clear=function(){t(this.layoutVertexArray)&&(this.layoutVertexArray=null),t(this.indexArray)&&(this.indexArray=null),t(this.indexArray2)&&(this.indexArray2=null)},m.prototype.addFeature=function(t,r,n,i){for(var a=0,s=e(r,500);a<s.length;a+=1){for(var u=s[a],l=0,p=0,c=u;p<c.length;p+=1){l+=c[p].length}for(var f=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),h=f.vertexLength,y=[],d=[],m=0,v=u;m<v.length;m+=1){var g=v[m];if(0!==g.length){g!==u[0]&&d.push(y.length/2);var x=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),b=x.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(b+g.length-1,b),y.push(g[0].x),y.push(g[0].y);for(var w=1;w<g.length;w++)this.layoutVertexArray.emplaceBack(g[w].x,g[w].y),this.indexArray2.emplaceBack(b+w-1,b+w),y.push(g[w].x),y.push(g[w].y);x.vertexLength+=g.length,x.primitiveLength+=g.length}}for(var _=o(y,d),C=0;C<_.length;C+=3)this.indexArray.emplaceBack(h+_[C],h+_[C+1],h+_[C+2]);f.vertexLength+=l,f.primitiveLength+=_.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i)},n.register("FillBucket",m,{omit:["layers","patternFeatures"]}),m}),define("MVT/data/array_types",["../util/web_worker_transfer"],function(t){var e=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},r=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};r.serialize=function(t,e){return t.isTransferred&&console.log("StructArray array.isTransferred."),t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},r.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},r.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},r.prototype.clear=function(){this.length=0},r.prototype.resize=function(t){this.reserve(t),this.length=t},r.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},r.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r)},e.prototype.emplace=function(t,e,r,n){var i=2*t,o=4*t;return this.uint32[i+0]=e,this.uint16[o+2]=r,this.uint16[o+3]=n,t},e}(r);n.prototype.bytesPerElement=8;var i=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,r),e}(e);i.prototype.size=8;var o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new i(this,t)},e}(n);return t.register("FeatureIndexArray",o,{omit:["layers","patternFeatures"]}),{FeatureIndexArray:o}}),define("MVT/pointGeometry",[],function(){"use strict";function t(t,e){this.x=t,this.y=e}return t.prototype={clone:function(){return new t(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},t.convert=function(e){return e instanceof t?e:Array.isArray(e)?new t(e[0],e[1]):e},t}),define("MVT/vectortilefeature",["./pointGeometry"],function(t){"use strict";function e(t,e,n,i,o){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=o,t.readFields(r,this,e)}function r(t,e,r){1==t?e.id=r.readVarint():2==t?n(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function n(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}function i(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],a=0;a<e;a++){var s=o(t[a]);0!==s&&(void 0===n&&(n=s<0),n===s<0?(r&&i.push(r),r=[t[a]]):r.push(t[a]))}return r&&i.push(r),i}function o(t){for(var e,r,n=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r=t[a],n+=(r.x-e.x)*(e.y+r.y);return n}return e.types=["Unknown","Point","LineString","Polygon"],e.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var r,n=e.readVarint()+e.pos,i=1,o=0,a=0,s=0,u=[];e.pos<n;){if(o<=0){var l=e.readVarint();i=7&l,o=l>>3}if(o--,1===i||2===i)a+=e.readSVarint(),s+=e.readSVarint(),1===i&&(r&&u.push(r),r=[]),r.push(new t(a,s));else{if(7!==i)throw new Error("unknown command "+i);r&&r.push(r[0].clone())}}return r&&u.push(r),u},e.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,l=-1/0;t.pos<e;){if(n<=0){var p=t.readVarint();r=7&p,n=p>>3}if(n--,1===r||2===r)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<u&&(u=o),o>l&&(l=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,u,s,l]},e.prototype.toGeoJSON=function(t,r,n){function o(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+p)/u;t[e]=[360*(r.x+l)/u-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}var a,s,u=this.extent*Math.pow(2,n),l=this.extent*t,p=this.extent*r,c=this.loadGeometry(),f=e.types[this.type];switch(this.type){case 1:var h=[];for(a=0;a<c.length;a++)h[a]=c[a][0];c=h,o(c);break;case 2:for(a=0;a<c.length;a++)o(c[a]);break;case 3:for(c=i(c),a=0;a<c.length;a++)for(s=0;s<c[a].length;s++)o(c[a][s])}1===c.length?c=c[0]:f="Multi"+f;var y={type:"Feature",geometry:{type:f,coordinates:c},properties:this.properties};return"id"in this&&(y.id=this.id),y},e}),define("MVT/vectortilelayer",["./vectortilefeature"],function(t){"use strict";function e(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(r,this,e),this.length=this._features.length}function r(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(n(r))}function n(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}return e.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var r=this._pbf.readVarint()+this._pbf.pos;return new t(this._pbf,r,this.extent,this._keys,this._values)},e}),define("MVT/vectortile",["./vectortilelayer"],function(t){"use strict";function e(t,e){this.layers=t.readFields(r,{},e)}function r(e,r,n){if(3===e){var i=new t(n,n.readVarint()+n.pos);i.length&&(r[i.name]=i)}}return e}),define("MVT/symbol/grid_index",["../util/web_worker_transfer"],function(t){function e(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var o=new Int32Array(this.arrayBuffer);t=o[0],e=o[1],n=o[2],this.d=e+2*n;for(var a=0;a<this.d*this.d;a++){var s=o[r+a],u=o[r+a+1];i.push(s===u?null:o.subarray(s,u))}var l=o[r+i.length],p=o[r+i.length+1];this.keys=o.subarray(l,p),this.bboxes=o.subarray(p),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var f=n/e*t;this.min=-f,this.max=t+f}var r=3;return e.prototype.insert=function(t,e,r,n,i){this._forEachCell(e,r,n,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},e.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},e.prototype._insertCell=function(t,e,r,n,i,o){this.cells[i].push(o)},e.prototype.query=function(t,e,r,n,i){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=r&&a<=n&&!i)return Array.prototype.slice.call(this.keys);var s=[],u={};return this._forEachCell(t,e,r,n,this._queryCell,s,u,i),s},e.prototype._queryCell=function(t,e,r,n,i,o,a,s){var u=this.cells[i];if(null!==u)for(var l=this.keys,p=this.bboxes,c=0;c<u.length;c++){var f=u[c];if(void 0===a[f]){var h=4*f;(s?s(p[h+0],p[h+1],p[h+2],p[h+3]):t<=p[h+2]&&e<=p[h+3]&&r>=p[h+0]&&n>=p[h+1])?(a[f]=!0,o.push(l[f])):a[f]=!1}}},e.prototype._forEachCell=function(t,e,r,n,i,o,a,s){for(var u=this._convertToCellCoord(t),l=this._convertToCellCoord(e),p=this._convertToCellCoord(r),c=this._convertToCellCoord(n),f=u;f<=p;f++)for(var h=l;h<=c;h++){var y=this.d*h+f;if((!s||s(this._convertFromCellCoord(f),this._convertFromCellCoord(h),this._convertFromCellCoord(f+1),this._convertFromCellCoord(h+1)))&&i.call(this,t,e,r,n,y,o,a,s))return}},e.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},e.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},e.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=r+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var o=new Int32Array(e+n+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var a=e,s=0;s<t.length;s++){var u=t[s];o[r+s]=a,o.set(u,a),a+=u.length}return o[r+t.length]=a,o.set(this.keys,a),a+=this.keys.length,o[r+t.length+1]=a,o.set(this.bboxes,a),a+=this.bboxes.length,o.buffer},t.register("GridIndex",e,{omit:["layers","patternFeatures"]}),e}),define("MVT/util/util",[],function(){"use strict";function t(){}t.easeCubicInOut=function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)},t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var n=t.length,i=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),i[a]=e,0==--n&&r(o,i)})})},t.extend=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t};var e=1;t.uniqueId=function(){return e++},t.uuid=function(){function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}return t()},t.validateUuid=function(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},t.bindAll=function(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})},t.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},t.mapObject=function(t,e,r){var n={};for(var i in t)n[i]=e.call(r||this,t[i],i,t);return n},t.filterObject=function(t,e,r){var n={};for(var i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n},t.clone=function(e){return Array.isArray(e)?e.map(t.clone):"object"==typeof e&&e?t.mapObject(e,t.clone):e},t.deepEqual=function(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var n=0;n<e.length;n++)if(!t.deepEqual(e[n],r[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(var i in e)if(!t.deepEqual(e[i],r[i]))return!1;return!0}return e===r},t.arraysIntersect=function(t,e){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1};t.isCounterClockwise=function(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)},t.isWorker=function(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope};var r=null;return t.isSafari=function(t){if(null==r){var e=t.navigator?t.navigator.userAgent:null;r=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return r},t.resolveTokens=function(t,e){return e.replace(/{([^{}]+)}/g,function(e,r){return r in t?String(t[r]):""})},t}),define("MVT/style-spec/expression/scope",[],function(){"use strict";var t=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,n=e;r<n.length;r+=1){var i=n[r],o=i[0],a=i[1];this.bindings[o]=a}};return t.prototype.concat=function(e){return new t(this,e)},t.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},t.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)},t}),define("MVT/style-spec/expression/parsing_error",[],function(){"use strict";return function(t){function e(e,r){t.call(this,r),this.message=r,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error)}),define("MVT/style-spec/expression/evaluation_context",[],function(){"use strict";var t=["Unknown","Point","LineString","Polygon"],e=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null};return e.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},e.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?t[this.feature.type]:this.feature.type:null},e.prototype.properties=function(){return this.feature&&this.feature.properties||{}},e.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Color.parse(t)),e},e}),define("MVT/style-spec/expression/is_constant",[],function(){"use strict";function t(){}return t.isFeatureConstant=function(e){if(e instanceof CompoundExpression){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}var r=!0;return e.eachChild(function(e){r&&!t.isFeatureConstant(e)&&(r=!1)}),r},t.isStateConstant=function(e){if(e instanceof CompoundExpression&&"feature-state"===e.name)return!1;var r=!0;return e.eachChild(function(e){r&&!t.isStateConstant(e)&&(r=!1)}),r},t.isGlobalPropertyConstant=function(e,r){if(e instanceof CompoundExpression&&r.indexOf(e.name)>=0)return!1;var n=!0;return e.eachChild(function(e){n&&!t.isGlobalPropertyConstant(e,r)&&(n=!1)}),n},t}),define("MVT/style-spec/expression/parsing_context",["./scope","./types","./parsing_error","./definitions/literal","./definitions/assertion","./definitions/coercion","./evaluation_context","./definitions/expressions","./is_constant"],function(t,e,r,n,i,o,a,s,u){"use strict";function l(t){return Array.isArray(t)?"("+t.map(toString).join(", ")+")":"("+toString(t.type)+"...)"}function p(t,e){return{kind:"array",itemType:t,N:e}}function c(t){return{type:t}}function f(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];r=r.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=Values.validateRGBA(r,n,i,a);if(s)throw new RuntimeError(s);return new Color(r/255*a,n/255*a,i/255*a,a)}var h=function(e,r,n,i,o){void 0===r&&(r=[]),void 0===i&&(i=new t),void 0===o&&(o=[]),this.registry=e,this.path=r,this.key=r.map(function(t){return"["+t+"]"}).join(""),this.scope=i,this.errors=o,this.expectedType=n};h.prototype.parse=function(t,e,r,n,i){return void 0===i&&(i={}),e?this.concat(e,r,n)._parse(t,i):this._parse(t,i)},h.prototype._parse=function(t,e){function r(t,e,r){return"assert"===r?new i(e,[t]):"coerce"===r?new o(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var s=t[0];if("string"!=typeof s)return this.error("Expression name must be a string, but found "+typeof s+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var l=this.registry[s];if(l){var p=l.parse(t,this);if(!p)return null;if(this.expectedType){var c=this.expectedType,f=p.type;if("string"!==c.kind&&"number"!==c.kind&&"boolean"!==c.kind&&"object"!==c.kind&&"array"!==c.kind||"value"!==f.kind)if("color"!==c.kind&&"formatted"!==c.kind&&"resolvedImage"!==c.kind||"value"!==f.kind&&"string"!==f.kind){if(this.checkSubtype(c,f))return null}else p=r(p,c,e.typeAnnotation||"coerce");else p=r(p,c,e.typeAnnotation||"assert")}if(!(p instanceof n)&&"resolvedImage"!==p.type.kind&&u(p)){var h=new a;try{p=new n(p.type,p.evaluate(h))}catch(t){return this.error(t.message),null}}return p}return this.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},h.prototype.concat=function(t,e,r){var n="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new h(this.registry,n,e||null,i,this.errors)},h.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new r(i,t))},h.prototype.checkSubtype=function(t,r){var n=e(t,r);return n&&this.error(n),n};var y=function(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n};y.prototype.evaluate=function(t){return this._evaluate(t,this.args)},y.prototype.eachChild=function(t){this.args.forEach(t)},y.prototype.possibleOutputs=function(){return[void 0]},y.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},y.parse=function(t,e){var r,n=t[0],i=y.definitions[n];if(!i)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1}),u=null,p=0,c=s;p<c.length;p+=1){var f=c[p],d=f[0],m=f[1];u=new h(e.registry,e.path,null,e.scope);for(var v=[],g=!1,x=1;x<t.length;x++){var b=t[x],w=Array.isArray(d)?d[x-1]:d.type,_=u.parse(b,1+v.length,w);if(!_){g=!0;break}v.push(_)}if(!g)if(Array.isArray(d)&&d.length!==v.length)u.error("Expected "+d.length+" arguments, but found "+v.length+" instead.");else{for(var C=0;C<v.length;C++){var A=Array.isArray(d)?d[C]:d.type,S=v[C];u.concat(C+1).checkSubtype(A,S.type)}if(0===u.errors.length)return new y(n,o,m,v)}}if(1===s.length)(r=e.errors).push.apply(r,u.errors);else{for(var E=s.length?s:a,k=E.map(function(t){return l(t[0])}).join(" | "),I=[],F=1;F<t.length;F++){var V=e.parse(t[F],1+I.length);if(!V)return null;I.push(toString(V.type))}e.error("Expected arguments of type "+k+", but found ("+I.join(", ")+") instead.")}return null},y.register=function(t,e){y.definitions=e;for(var r in e)t[r]=y};var d={kind:"number"},m={kind:"string"},v={kind:"boolean"},g={kind:"color"},x={kind:"object"},b={kind:"value"},w={kind:"error"},_={kind:"collator"};return y.register(s,{error:[w,[m],function(t,e){var r=e[0];throw new RuntimeError(r.evaluate(t))}],typeof:[m,[b],function(t,e){var r=e[0];return toString(Values.typeOf(r.evaluate(t)))}],"to-rgba":[p(d,4),[g],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[g,[d,d,d],f],rgba:[g,[d,d,d,d],f],has:{type:v,overloads:[[[m],function(t,e){var r=e[0];return has(r.evaluate(t),t.properties())}],[[m,x],function(t,e){var r=e[0],n=e[1];return has(r.evaluate(t),n.evaluate(t))}]]},get:{type:b,overloads:[[[m],function(t,e){var r=e[0];return get(r.evaluate(t),t.properties())}],[[m,x],function(t,e){var r=e[0],n=e[1];return get(r.evaluate(t),n.evaluate(t))}]]},"feature-state":[b,[m],function(t,e){var r=e[0];return get(r.evaluate(t),t.featureState||{})}],properties:[x,[],function(t){return t.properties()}],"geometry-type":[m,[],function(t){return t.geometryType()}],id:[b,[],function(t){return t.id()}],zoom:[d,[],function(t){return t.globals.zoom}],"heatmap-density":[d,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[d,[],function(t){return t.globals.lineProgress||0}],accumulated:[b,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[d,c(d),function(t,e){for(var r=0,n=0,i=e;n<i.length;n+=1){r+=i[n].evaluate(t)}return r}],"*":[d,c(d),function(t,e){for(var r=1,n=0,i=e;n<i.length;n+=1){r*=i[n].evaluate(t)}return r}],"-":{type:d,overloads:[[[d,d],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)-n.evaluate(t)}],[[d],function(t,e){return-e[0].evaluate(t)}]]},"/":[d,[d,d],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)/n.evaluate(t)}],"%":[d,[d,d],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)%n.evaluate(t)}],
ln2:[d,[],function(){return Math.LN2}],pi:[d,[],function(){return Math.PI}],e:[d,[],function(){return Math.E}],"^":[d,[d,d],function(t,e){var r=e[0],n=e[1];return Math.pow(r.evaluate(t),n.evaluate(t))}],sqrt:[d,[d],function(t,e){var r=e[0];return Math.sqrt(r.evaluate(t))}],log10:[d,[d],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN10}],ln:[d,[d],function(t,e){var r=e[0];return Math.log(r.evaluate(t))}],log2:[d,[d],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN2}],sin:[d,[d],function(t,e){var r=e[0];return Math.sin(r.evaluate(t))}],cos:[d,[d],function(t,e){var r=e[0];return Math.cos(r.evaluate(t))}],tan:[d,[d],function(t,e){var r=e[0];return Math.tan(r.evaluate(t))}],asin:[d,[d],function(t,e){var r=e[0];return Math.asin(r.evaluate(t))}],acos:[d,[d],function(t,e){var r=e[0];return Math.acos(r.evaluate(t))}],atan:[d,[d],function(t,e){var r=e[0];return Math.atan(r.evaluate(t))}],min:[d,c(d),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[d,c(d),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[d,[d],function(t,e){var r=e[0];return Math.abs(r.evaluate(t))}],round:[d,[d],function(t,e){var r=e[0],n=r.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[d,[d],function(t,e){var r=e[0];return Math.floor(r.evaluate(t))}],ceil:[d,[d],function(t,e){var r=e[0];return Math.ceil(r.evaluate(t))}],"filter-==":[v,[m,b],function(t,e){var r=e[0],n=e[1];return t.properties()[r.value]===n.value}],"filter-id-==":[v,[b],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[v,[m],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[v,[m,b],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i<o}],"filter-id-<":[v,[b],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n<i}],"filter->":[v,[m,b],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i>o}],"filter-id->":[v,[b],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n>i}],"filter-<=":[v,[m,b],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[v,[b],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n<=i}],"filter->=":[v,[m,b],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[v,[b],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n>=i}],"filter-has":[v,[b],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[v,[],function(t){return null!==t.id()}],"filter-type-in":[v,[p(m)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[v,[p(b)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[v,[m,p(b)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[v,[m,p(b)],function(t,e){var r=e[0],n=e[1];return binarySearch(t.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:v,overloads:[[[v,v],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)&&n.evaluate(t)}],[c(v),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(!n[r].evaluate(t))return!1}return!0}]]},any:{type:v,overloads:[[[v,v],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)||n.evaluate(t)}],[c(v),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(n[r].evaluate(t))return!0}return!1}]]},"!":[v,[v],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[v,[m],function(t,e){var r=e[0],n=t.globals&&t.globals.isSupportedScript;return!n||n(r.evaluate(t))}],upcase:[m,[m],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[m,[m],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[m,c(b),function(t,e){return e.map(function(e){return Values.toString$1(e.evaluate(t))}).join("")}],"resolved-locale":[m,[_],function(t,e){return e[0].evaluate(t).resolvedLocale()}]}),h}),define("MVT/style-spec/expression/styleExpression",["./evaluation_context"],function(t){"use strict";function e(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function r(t){return"color"===t.type&&e(t.default)?new Color(0,0,0,0):"color"===t.type?Color.parse(t.default)||null:void 0===t.default?null:t.default}var n=function(e,n){this.expression=e,this._warningHistory={},this._evaluator=new t,this._defaultValue=n?r(n):null,this._enumValues=n&&"enum"===n.type?n.values:null};return n.prototype.evaluateWithoutErrorHandling=function(t,e,r,n,i){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)},n.prototype.evaluate=function(t,e,r,n,i){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=i||null;try{var o=this.expression.evaluate(this._evaluator);if(null===o||void 0===o||"number"==typeof o&&o!==o)return this._defaultValue;if(this._enumValues&&!(o in this._enumValues))throw new RuntimeError("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(o)+" instead.");return o}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}},n}),define("MVT/style-spec/expression/expression",["./parsing_context","./styleExpression","./definitions/expressions","../util/color"],function(t,e,r,n){"use strict";function i(){}function o(t){return{result:"success",value:t}}function a(t){return{result:"error",value:t}}function s(t,e){return{kind:"array",itemType:t,N:e}}function u(t){var e={color:d,string:h,number:f,enum:h,boolean:y,formatted:v,resolvedImage:g};return"array"===t.type?s(e[t.value]||m,t.length):e[t.type]}function l(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function p(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t}function c(t,e){var r="color"===e.type,i=t.stops&&"object"==typeof t.stops[0][0],o=i||void 0!==t.property,a=i||!o,s=t.type||(supportsInterpolation(e)?"exponential":"interval");if(r&&(t=p({},t),t.stops&&(t.stops=t.stops.map(function(t){return[t[0],n.parse(t[1])]})),t.default?t.default=n.parse(t.default):t.default=n.parse(e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!colorSpaces[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);var u,l,f;if("exponential"===s)u=evaluateExponentialFunction;else if("interval"===s)u=evaluateIntervalFunction;else if("categorical"===s){u=evaluateCategoricalFunction,l=Object.create(null);for(var h=0,y=t.stops;h<y.length;h+=1){var d=y[h];l[d[0]]=d[1]}f=typeof t.stops[0][0]}else{if("identity"!==s)throw new Error('Unknown function type "'+s+'"');u=evaluateIdentityFunction}if(i){for(var m={},v=[],g=0;g<t.stops.length;g++){var x=t.stops[g],b=x[0].zoom;void 0===m[b]&&(m[b]={zoom:b,type:t.type,property:t.property,default:t.default,stops:[]},v.push(b)),m[b].stops.push([x[0].value,x[1]])}for(var w=[],_=0,C=v;_<C.length;_+=1){var A=C[_];w.push([m[A].zoom,c(m[A],e)])}var S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:Interpolate.interpolationFactor.bind(void 0,S),zoomStops:w.map(function(t){return t[0]}),evaluate:function(r,n){var i=r.zoom;return evaluateExponentialFunction({stops:w,base:t.base},e,i).evaluate(i,n)}}}if(a){var E="exponential"===s?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:Interpolate.interpolationFactor.bind(void 0,E),zoomStops:t.stops.map(function(t){return t[0]}),evaluate:function(r){var n=r.zoom;return u(t,e,n,l,f)}}}return{kind:"source",evaluate:function(r,n){var i=n&&n.properties?n.properties[t.property]:void 0;return void 0===i?coalesce(t.default,e.default):u(t,e,i,l,f)}}}i.isExpression=function(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in r};var f={kind:"number"},h={kind:"string"},y={kind:"boolean"},d={kind:"color"},m={kind:"value"},v={kind:"formatted"},g={kind:"resolvedImage"};i.createExpression=function(n,i){var s=new t(r,[],i?u(i):void 0),l=s.parse(n,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return l?o(new e(l,i)):a(s.errors)};var x=function(t,e){this._parameters=t,this._specification=e,p(this,c(this._parameters,this._specification))};return x.deserialize=function(t){return new x(t._parameters,t._specification)},x.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}},i.normalizePropertyExpression=function(t,e){if(l(t))return new x(t,e);if(i.isExpression(t)){var r=createPropertyExpression(t,e);if("error"===r.result)throw new Error(r.value.map(function(t){return t.key+": "+t.message}).join(", "));return r.value}var o=t;return"string"==typeof t&&"color"===e.type&&(o=n.parse(t)),{kind:"constant",evaluate:function(){return o}}},i}),define("MVT/style-spec/feature_filter/featureFilter",["../expression/expression"],function(t){"use strict";function e(){}function r(t,e){return t<e?-1:t>e?1:0}function n(t){if(!t)return!0;var e=t[0];return t.length<=1?"any"!==e:"=="===e?i(t[1],t[2],"=="):"!="===e?u(i(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?i(t[1],t[2],e):"any"===e?o(t.slice(1)):"all"===e?["all"].concat(t.slice(1).map(n)):"none"===e?["all"].concat(t.slice(1).map(n).map(u)):"in"===e?a(t[1],t.slice(2)):"!in"===e?u(a(t[1],t.slice(2))):"has"===e?s(t[1]):"!has"!==e||u(s(t[1]))}function i(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function o(t){return["any"].concat(t.map(n))}function a(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(r)]]:["filter-in-small",t,["literal",e]]}}function s(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function u(t){return["!",t]}e.isExpressionFilter=function(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&Array.isArray(t[2]);case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var r=0,n=t.slice(1);r<n.length;r+=1){var i=n[r];if(!e.isExpressionFilter(i)&&"boolean"!=typeof i)return!1}return!0;default:return!0}};var l={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};return e.createFilter=function(r){if(null===r||void 0===r)return function(){return!0};e.isExpressionFilter(r)||(r=n(r));var i=t.createExpression(r,l);if("error"===i.result)throw new Error(i.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,e){return i.value.evaluate(t,e)}},e}),define("MVT/data/feature_index",["./array_types","./extent","./load_geometry","../DictionaryCoder","../vectortile","../symbol/grid_index","../util/util","../util/web_worker_transfer","../style/evaluation_parameters","../style-spec/feature_filter/featureFilter","../../core/defined","../../ThirdParty/pbf"],function(t,e,r,n,i,o,a,s,u,l,p,c){function f(t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=0,a=t;o<a.length;o+=1){var s=a[o];e=Math.min(e,s.x),r=Math.min(r,s.y),n=Math.max(n,s.x),i=Math.max(i,s.y)}return{minX:e,minY:r,maxX:n,maxY:i}}function h(t,e){return e-t}var y=t.FeatureIndexArray,d=function(t,r,n){this.x=t.x,this.y=t.y,this.z=t.z,this.grid=r||new o(e,16,0),this.featureIndexArray=n||new y};d.prototype.insert=function(t,r,n,i,o,a){var s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,o);for(var u=this.grid,l=0;l<r.length;l++){for(var p=r[l],c=[1/0,1/0,-1/0,-1/0],f=0;f<p.length;f++){var h=p[f];c[0]=Math.min(c[0],h.x),c[1]=Math.min(c[1],h.y),c[2]=Math.max(c[2],h.x),c[3]=Math.max(c[3],h.y)}c[0]<e&&c[1]<e&&c[2]>=0&&c[3]>=0&&u.insert(s,c[0],c[1],c[2],c[3])}},d.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new i(new c(this.rawTileData)).layers,this.sourceLayerCoder=new n(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},d.prototype.query=function(t,n,i){var o=this;this.loadVTLayers();var a=t.params||{},s=e/t.tileSize,u=l.createFilter(a.filter),p=t.queryGeometry,c=f(p),y=this.grid.query(c.minX-5,c.minY-5,c.maxX+5,c.maxY+5);y.sort(h);for(var d,m={},v=0;v<y.length;v++)!function(e){var i=y[e];if(i!==d){d=i;var l=o.featureIndexArray.get(i),c=null;o.loadMatchingFeature(m,l.bucketIndex,l.sourceLayerIndex,l.featureIndex,u,a.layers,n,function(e,n){c||(c=r(e));var i={};return n.queryIntersectsFeature(p,e,i,c,o.z,t.transform,s,t.pixelPosMatrix)})}}(v);return m},d.prototype.loadMatchingFeature=function(t,e,r,n,i,o,s,l){if(p(e)&&p(r)&&p(n)){var c=this.bucketLayerIDs[e];if(!o||a.arraysIntersect(o,c)){var f=this.sourceLayerCoder.decode(r),h=this.vtLayers[f],y=h.feature(n);if(i(new u(this.z),y))for(var d=0;d<c.length;d++){var m=c[d];if(!(o&&o.indexOf(m)<0)){var v=s[m];if(v){var g=!l||l(y,v);if(g){y.layer=v.serialize();var x=t[m];void 0===x&&(x=t[m]=[]),x.push({featureIndex:n,feature:y,intersectionZ:g})}}}}}}},d.prototype.lookupSymbolFeatures=function(t,e,r,n,i,o){var a={};this.loadVTLayers();for(var s=createFilter(n),u=0,l=t;u<l.length;u+=1){var p=l[u];this.loadMatchingFeature(a,e,r,p,s,i,o)}return a},d.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var n=r[e],i=0,o=n;i<o.length;i+=1){var a=o[i];if(t===a)return!0}return!1};return s.register("FeatureIndex",d,{omit:["rawTileData","sourceLayerCoder","vtLayers"]}),d}),define("MVT/group_by_layout",[],function(){"use strict";function t(e){var r=typeof e;if("number"===r||"boolean"===r||"string"===r||void 0===e||null===e)return JSON.stringify(e);if(Array.isArray(e)){for(var n="[",i=0,o=e;i<o.length;i+=1){n+=t(o[i])+","}return n+"]"}for(var a=Object.keys(e).sort(),s="{",u=0;u<a.length;u++)s+=JSON.stringify(a[u])+":"+t(e[a[u]])+",";return s+"}"}function e(e){for(var r="",i=0,o=n;i<o.length;i+=1){r+="/"+t(e[o[i]])}return r}function r(t,r){for(var n={},i=0;i<t.length;i++){var o=r&&r[t[i].id]||e(t[i]);r&&(r[t[i].id]=o);var a=n[o];a||(a=n[o]=[]),a.push(t[i])}var s=[];for(var u in n)s.push(n[u]);return s}const n=["type","source","source-layer","minzoom","maxzoom","filter","layout"];return r}),define("MVT/data/bucket/circle_bucket",["../../../core/defined","../../util/createLayout","../../util/web_worker_transfer","../../style/evaluation_parameters","../load_geometry","../segment","../StructArrayLayout2i4","../StructArrayLayout3ui6","../programConfigurationSet","../extent"],function(t,e,r,n,i,o,a,s,u,l){"use strict";function p(t,e,r,n,i){t.emplaceBack(2*e+(n+1)/2,2*r+(i+1)/2)}var c=e([{name:"a_pos",components:2,type:"Int16"}],4),f=c.members,h=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new a,this.indexArray=new s,this.segments=new o,this.programConfigurations=new u(f,t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};return h.prototype.populate=function(t,e){var r=this.layers[0],o=[],a=null;"circle"===r.type&&(a=r.layout.get("circle-sort-key"));for(var s=0,u=t;s<u.length;s+=1){var l=u[s],p=l.feature,c=l.index,f=l.sourceLayerIndex;if(this.layers[0]._featureFilter(new n(0),p)){var h=i(p),y=a?a.evaluate(p,{}):void 0,d={id:p.id,properties:p.properties,type:p.type,sourceLayerIndex:f,index:c,geometry:h,patterns:{},sortKey:y};o.push(d)}}a&&o.sort(function(t,e){return t.sortKey-e.sortKey});for(var m=0,v=o;m<v.length;m+=1){var g=v[m],x=g,b=x.geometry,w=x.index,_=x.sourceLayerIndex,C=t[w].feature;this.addFeature(g,b,w),e.featureIndex.insert(C,b,w,_,this.index)}},h.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},h.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},h.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},h.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,f),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},h.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},h.prototype.addFeature=function(t,e,r){for(var n=0,i=e;n<i.length;n+=1)for(var o=i[n],a=0,s=o;a<s.length;a+=1){var u=s[a],c=u.x,f=u.y;if(!(c<0||c>=l||f<0||f>=l)){var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),y=h.vertexLength;p(this.layoutVertexArray,c,f,-1,-1),p(this.layoutVertexArray,c,f,1,-1),p(this.layoutVertexArray,c,f,1,1),p(this.layoutVertexArray,c,f,-1,1),this.indexArray.emplaceBack(y,y+1,y+2),this.indexArray.emplaceBack(y,y+3,y+2),h.vertexLength+=4,h.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{})},r.register("CircleBucket",h,{omit:["layers"]}),h}),define("MVT/style/dataConstantProperty",["../util/web_worker_transfer"],function(t){"use strict";var e=function(t){this.specification=t};return e.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},e.prototype.interpolate=function(t,e,r){var n=interpolate[this.specification.type];return n?n(t,e,r):t},t.register("DataConstantProperty",e),e}),define("MVT/style/dataDrivenProperty",["../util/web_worker_transfer","./possiblyEvaluatedPropertyValue"],function(t,e){"use strict";var r=function(t,e){this.specification=t,this.overrides=e};return r.prototype.possiblyEvaluate=function(t,r,n){return"constant"===t.expression.kind||"camera"===t.expression.kind?new e(this,{kind:"constant",value:t.expression.evaluate(r,null,{},n)},r):new e(this,t.expression,r)},r.prototype.interpolate=function(t,r,n){if("constant"!==t.value.kind||"constant"!==r.value.kind)return t;if(void 0===t.value.value||void 0===r.value.value)return new e(this,{kind:"constant",value:void 0},t.parameters);var i=interpolate[this.specification.type];return i?new e(this,{kind:"constant",value:i(t.value.value,r.value.value,n)},t.parameters):t},r.prototype.evaluate=function(t,e,r,n,i){return"constant"===t.kind?t.value:t.evaluate(e,r,n,i)},t.register("DataDrivenProperty",r),r}),define("MVT/style/propertyValue",["../style-spec/expression/expression"],function(t){"use strict";var e=function(e,r){this.property=e,this.value=r,this.expression=t.normalizePropertyExpression(void 0===r?e.specification.default:r,e.specification)};return e.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},e.prototype.possiblyEvaluate=function(t,e){return this.property.possiblyEvaluate(this,t,e)},e}),define("MVT/style/transitioningPropertyValue",[],function(){"use strict";function t(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}var e=function(t,e,r,n,i){this.property=t,this.value=e,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,t.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};return e.prototype.possiblyEvaluate=function(e,r){var n=e.now||0,i=this.value.possiblyEvaluate(e,r),o=this.prior;if(o){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return o.possiblyEvaluate(e,r);var a=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,r),i,t(a))}return i},e}),define("MVT/Util/util",[],function(){"use strict";function t(){}t.easeCubicInOut=function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)},t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var n=t.length,i=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),i[a]=e,0==--n&&r(o,i)})})},t.extend=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t};var e=1;t.uniqueId=function(){return e++},t.uuid=function(){function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}return t()},t.validateUuid=function(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},t.bindAll=function(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})},t.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},t.mapObject=function(t,e,r){var n={};for(var i in t)n[i]=e.call(r||this,t[i],i,t);return n},t.filterObject=function(t,e,r){var n={};for(var i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n},t.clone=function(e){return Array.isArray(e)?e.map(t.clone):"object"==typeof e&&e?t.mapObject(e,t.clone):e},t.deepEqual=function(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var n=0;n<e.length;n++)if(!t.deepEqual(e[n],r[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(var i in e)if(!t.deepEqual(e[i],r[i]))return!1;return!0}return e===r},t.arraysIntersect=function(t,e){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1};t.isCounterClockwise=function(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)},t.isWorker=function(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope};var r=null;return t.isSafari=function(t){if(null==r){var e=t.navigator?t.navigator.userAgent:null;r=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return r},t.resolveTokens=function(t,e){return e.replace(/{([^{}]+)}/g,function(e,r){return r in t?String(t[r]):""})},t}),define("MVT/style/transitionablePropertyValue",["./propertyValue","./transitioningPropertyValue","../Util/util"],function(t,e,r){"use strict";var n=function(e){this.property=e,this.value=new t(e,void 0)};return n.prototype.transitioned=function(t,n){return new e(this.property,this.value,n,r.extend({},t.transition,this.transition),t.now)},n.prototype.untransitioned=function(){return new e(this.property,this.value,null,{},0)},n}),define("MVT/style/properties",["./propertyValue","./transitionablePropertyValue"],function(t,e){"use strict";return function(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(var n in r){var i=r[n];i.specification.overridable&&this.overridableProperties.push(n);var o=this.defaultPropertyValues[n]=new t(i,void 0),a=this.defaultTransitionablePropertyValues[n]=new e(i);this.defaultTransitioningPropertyValues[n]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=o.possiblyEvaluate({})}}}),define("MVT/style/query_utils",["../pointGeometry"],function(t){"use strict";function e(){}return e.getMaximumPaintValue=function(t,e,r){var n=e.paint.get(t).value;return"constant"===n.kind?n.value:r.programConfigurations.get(e.id).binders[t].maxValue},e.translateDistance=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},e.translate=function(e,r,n,i,o){if(!r[0]&&!r[1])return e;var a=t.convert(r)._mult(o);"viewport"===n&&a._rotate(-i);for(var s=[],u=0;u<e.length;u++){var l=e[u];s.push(l.sub(a))}return s},e}),define("MVT/style/possiblyEvaluated",[],function(){"use strict";var t=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};return t.prototype.get=function(t){return this._values[t]},t}),define("MVT/style/layout",["./propertyValue","./possiblyEvaluated","../util/util"],function(t,e,r){"use strict";var n=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};return n.prototype.getValue=function(t){return r.clone(this._values[t].value)},n.prototype.setValue=function(e,n){this._values[e]=new t(this._values[e].property,null===n?void 0:r.clone(n))},n.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],i=this.getValue(n);void 0!==i&&(t[n]=i)}return t},n.prototype.possiblyEvaluate=function(t,r){for(var n=new e(this._properties),i=0,o=Object.keys(this._values);i<o.length;i+=1){var a=o[i];n._values[a]=this._values[a].possiblyEvaluate(t,r)}return n},n}),define("MVT/style/transitioning",["./possiblyEvaluated"],function(t){"use strict";var e=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};return e.prototype.possiblyEvaluate=function(e,r){for(var n=new t(this._properties),i=0,o=Object.keys(this._values);i<o.length;i+=1){var a=o[i];n._values[a]=this._values[a].possiblyEvaluate(e,r)}return n},e.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var r=e[t];if(this._values[r].prior)return!0}return!1},e}),define("MVT/style/transitionable",["./propertyValue","./transitionablePropertyValue","./transitioning","../util/util"],function(t,e,r,n){"use strict";var i=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};return i.prototype.getValue=function(t){return n.clone(this._values[t].value.value)},i.prototype.setValue=function(r,i){this._values.hasOwnProperty(r)||(this._values[r]=new e(this._values[r].property)),this._values[r].value=new t(this._values[r].property,null===i?void 0:n.clone(i))},i.prototype.getTransition=function(t){return n.clone(this._values[t].transition)},i.prototype.setTransition=function(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new e(this._values[t].property)),this._values[t].transition=n.clone(r)||void 0},i.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],i=this.getValue(n);void 0!==i&&(t[n]=i);var o=this.getTransition(n);void 0!==o&&(t[n+"-transition"]=o)}return t},i.prototype.transitioned=function(t,e){for(var n=new r(this._properties),i=0,o=Object.keys(this._values);i<o.length;i+=1){var a=o[i];n._values[a]=this._values[a].transitioned(t,e._values[a])}return n},i.prototype.untransitioned=function(){for(var t=new r(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e];t._values[i]=this._values[i].untransitioned()}return t},i}),define("MVT/style/style_layer",["./layout","./transitionable","../util/util"],function(t,e,r){"use strict";function n(t,e){return-1!==t.indexOf(e,t.length-e.length)}function i(r,n){if(this.id=r.id,this.type=r.type,"custom"!==r.type&&(r=r,this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),n.layout&&(this._unevaluatedLayout=new t(n.layout)),n.paint)){this._transitionablePaint=new e(n.paint);for(var i in r.paint)this.setPaintProperty(i,r.paint[i],{validate:!1});for(var o in r.layout)this.setLayoutProperty(o,r.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return i.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},i.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},i.prototype.setLayoutProperty=function(t,e,r){if(void 0===r&&(r={}),null!==e&&void 0!==e){this.id}if("visibility"===t)return void(this.visibility=e);this._unevaluatedLayout.setValue(t,e)},i.prototype.getPaintProperty=function(t){return n(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},i.prototype.setPaintProperty=function(t,e,r){if(void 0===r&&(r={}),null!==e&&void 0!==e){this.id}if(n(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],o="cross-faded-data-driven"===i.property.specification["property-type"],a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var u=this._transitionablePaint._values[t].value;return u.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(t,s,u)},i.prototype._handleSpecialPaintPropertyUpdate=function(t){},i.prototype._handleOverridablePaintPropertyUpdate=function(t,e,r){return!1},i.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||(!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility)},i.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},i.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},i.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,e)},i.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),r.filterObject(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},i.prototype._validate=function(t,e,r,n,i){return!0},i.prototype.is3D=function(){return!1},i.prototype.isTileClipped=function(){return!1},i.prototype.hasOffscreenPass=function(){return!1},i.prototype.resize=function(){},i.prototype.isStateDependent=function(){return!0},i}),define("MVT/style/style_spec",[],function(){"use strict";return{$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},
tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}}}),define("MVT/util/intersection_tests",["./util","../pointGeometry"],function(t,e){"use strict";function r(){}function n(t,e,r){if(t.length>1){if(i(t,e))return!0;for(var n=0;n<e.length;n++)if(a(e[n],t,r))return!0}for(var o=0;o<t.length;o++)if(a(t[o],e,r))return!0;return!1}function i(t,e){if(0===t.length||0===e.length)return!1;for(var r=0;r<t.length-1;r++)for(var n=t[r],i=t[r+1],a=0;a<e.length-1;a++){var s=e[a],u=e[a+1];if(o(n,i,s,u))return!0}return!1}function o(e,r,n,i){return t.isCounterClockwise(e,n,i)!==t.isCounterClockwise(r,n,i)&&t.isCounterClockwise(e,r,n)!==t.isCounterClockwise(e,r,i)}function a(t,e,n){var i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(var o=1;o<e.length;o++){var a=e[o-1],s=e[o];if(r.distToSegmentSquared(t,a,s)<i)return!0}return!1}function s(t,e){for(var r,n,i,o=!1,a=0;a<t.length;a++){r=t[a];for(var s=0,u=r.length-1;s<r.length;u=s++)n=r[s],i=r[u],n.y>e.y!=i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(o=!o)}return o}function u(t,e){for(var r=!1,n=0,i=t.length-1;n<t.length;i=n++){var o=t[n],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}return r.polygonIntersectsPolygon=function(t,e){for(var r=0;r<t.length;r++)if(u(e,t[r]))return!0;for(var n=0;n<e.length;n++)if(u(t,e[n]))return!0;return!!i(t,e)},r.polygonIntersectsBufferedPoint=function(t,e,r){return!!u(t,e)||!!a(e,t,r)},r.polygonIntersectsMultiPolygon=function(t,e){if(1===t.length)return s(e,t[0]);for(var r=0;r<e.length;r++)for(var n=e[r],o=0;o<n.length;o++)if(u(t,n[o]))return!0;for(var a=0;a<t.length;a++)if(s(e,t[a]))return!0;for(var l=0;l<e.length;l++)if(i(t,e[l]))return!0;return!1},r.polygonIntersectsBufferedMultiLine=function(t,e,r){for(var i=0;i<e.length;i++){var o=e[i];if(t.length>=3)for(var a=0;a<o.length;a++)if(u(t,o[a]))return!0;if(n(t,o,r))return!0}return!1},r.distToSegmentSquared=function(t,e,r){var n=e.distSqr(r);if(0===n)return t.distSqr(e);var i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))},r}),define("MVT/style/style_layer/circle_style_layer",["../../pointGeometry","../../data/bucket/circle_bucket","../dataConstantProperty","../dataDrivenProperty","../evaluation_parameters","../properties","../query_utils","../style_layer","../style_spec","../../util/intersection_tests"],function(t,e,r,n,i,o,a,s,u,l){"use strict";function p(e,r){var n=h([],[e.x,e.y,0,1],r);return new t(n[0],n[1])}function c(t,e){return t.map(function(t){return p(t,e)})}function f(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function h(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,t}var y=new o({"circle-sort-key":new n(u.layout_circle["circle-sort-key"])}),d=new o({"circle-radius":new n(u.paint_circle["circle-radius"]),
"circle-color":new n(u.paint_circle["circle-color"]),"circle-blur":new n(u.paint_circle["circle-blur"]),"circle-opacity":new n(u.paint_circle["circle-opacity"]),"circle-translate":new r(u.paint_circle["circle-translate"]),"circle-translate-anchor":new r(u.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new r(u.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new r(u.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new n(u.paint_circle["circle-stroke-width"]),"circle-stroke-color":new n(u.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new n(u.paint_circle["circle-stroke-opacity"])}),m={paint:d,layout:y};return function(t){function r(e){t.call(this,e,m)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.createBucket=function(t){return new e(t)},r.prototype.queryRadius=function(t){var e=t;return a.getMaximumPaintValue("circle-radius",this,e)+a.getMaximumPaintValue("circle-stroke-width",this,e)+a.translateDistance(this.paint.get("circle-translate"))},r.prototype.queryIntersectsFeature=function(t,e,r,n,i,o,s,u){u=f();for(var y=a.translate(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),0,s),d=this.paint.get("circle-radius").evaluate(e,r),m=this.paint.get("circle-stroke-width").evaluate(e,r),v=d+m,g="map"===this.paint.get("circle-pitch-alignment"),x=g?y:c(y,u),b=g?v*s:v,w=0,_=n;w<_.length;w+=1)for(var C=_[w],A=0,S=C;A<S.length;A+=1){var E=S[A],k=g?E:p(E,u),I=b;h([],[E.x,E.y,0,1],u);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")||"map"===this.paint.get("circle-pitch-scale")&&this.paint.get("circle-pitch-alignment"),I*=10,l.polygonIntersectsBufferedPoint(x,k,I))return!0}return!1},r}(s)}),define("MVT/style/crossFadedDataDrivenProperty",["../util/web_worker_transfer","./possiblyEvaluatedPropertyValue","./dataDrivenProperty"],function(t,e,r){"use strict";var n=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.possiblyEvaluate=function(t,r,n){if(void 0===t.value)return new e(this,{kind:"constant",value:void 0},r);if("constant"===t.expression.kind){var i=t.expression.evaluate(r,null,{},n),o="resolvedImage"===t.property.specification.type,a=o&&"string"!=typeof i?i.name:i,s=this._calculate(a,a,a,r);return new e(this,{kind:"constant",value:s},r)}if("camera"===t.expression.kind){var u=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new e(this,{kind:"constant",value:u},r)}return new e(this,t.expression,r)},r.prototype.evaluate=function(t,e,r,n,i){if("source"===t.kind){var o=t.evaluate(e,r,n,i);return this._calculate(o,o,o,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},r,n),t.evaluate({zoom:Math.floor(e.zoom)},r,n),t.evaluate({zoom:Math.floor(e.zoom)+1},r,n),e):t.value},r.prototype._calculate=function(t,e,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},r.prototype.interpolate=function(t){return t},r}(r);return t.register("DataDrivenProperty",r),n}),define("MVT/style/style_layer/fill_style_layer",["../../data/bucket/fill_bucket","../crossFadedDataDrivenProperty","../dataConstantProperty","../dataDrivenProperty","../properties","../query_utils","../style_layer","../style_spec","../../util/intersection_tests"],function(t,e,r,n,i,o,a,s,u){"use strict";var l=new i({"fill-sort-key":new n(s.layout_fill["fill-sort-key"])}),p=new i({"fill-antialias":new r(s.paint_fill["fill-antialias"]),"fill-opacity":new n(s.paint_fill["fill-opacity"]),"fill-color":new n(s.paint_fill["fill-color"]),"fill-outline-color":new n(s.paint_fill["fill-outline-color"]),"fill-translate":new r(s.paint_fill["fill-translate"]),"fill-translate-anchor":new r(s.paint_fill["fill-translate-anchor"]),"fill-pattern":new e(s.paint_fill["fill-pattern"])}),c={paint:p,layout:l};return function(e){function r(t){e.call(this,t,c)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.recalculate=function(t,r){e.prototype.recalculate.call(this,t,r);var n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},r.prototype.createBucket=function(e){return new t(e)},r.prototype.queryRadius=function(){return o.translateDistance(this.paint.get("fill-translate"))},r.prototype.queryIntersectsFeature=function(t,e,r,n,i,a,s){var l=o.translate(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),0,s);return u.polygonIntersectsMultiPolygon(l,n)},r.prototype.isTileClipped=function(){return!0},r}(a)}),define("MVT/style/crossFadedProperty",["../util/web_worker_transfer"],function(t){"use strict";var e=function(t){this.specification=t};return e.prototype.possiblyEvaluate=function(t,e,r){if(void 0!==t.value){if("constant"===t.expression.kind){var n=t.expression.evaluate(e,null,{},r);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new EvaluationParameters(Math.floor(e.zoom-1),e)),t.expression.evaluate(new EvaluationParameters(Math.floor(e.zoom),e)),t.expression.evaluate(new EvaluationParameters(Math.floor(e.zoom+1),e)),e)}},e.prototype._calculate=function(t,e,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},e.prototype.interpolate=function(t){return t},t.register("CrossFadedProperty",e),e}),define("MVT/style/colorRampProperty",["../util/web_worker_transfer"],function(t){"use strict";var e=function(t){this.specification=t};return e.prototype.possiblyEvaluate=function(t,e,r){return!!t.expression.evaluate(e,null,{},r)},e.prototype.interpolate=function(){return!1},t.register("ColorRampProperty",e),e}),define("MVT/style/style_layer/line_style_layer",["../../pointGeometry","../../data/bucket/line_bucket","../crossFadedDataDrivenProperty","../crossFadedProperty","../colorRampProperty","../dataConstantProperty","../dataDrivenProperty","../evaluation_parameters","../properties","../query_utils","../style_layer","../style_spec","../../util/intersection_tests"],function(t,e,r,n,i,o,a,s,u,l,p,c,f){"use strict";var h=new u({"line-cap":new o(c.layout_line["line-cap"]),"line-join":new a(c.layout_line["line-join"]),"line-miter-limit":new o(c.layout_line["line-miter-limit"]),"line-round-limit":new o(c.layout_line["line-round-limit"]),"line-sort-key":new a(c.layout_line["line-sort-key"])}),y=new u({"line-opacity":new a(c.paint_line["line-opacity"]),"line-color":new a(c.paint_line["line-color"]),"line-translate":new o(c.paint_line["line-translate"]),"line-translate-anchor":new o(c.paint_line["line-translate-anchor"]),"line-width":new a(c.paint_line["line-width"]),"line-gap-width":new a(c.paint_line["line-gap-width"]),"line-offset":new a(c.paint_line["line-offset"]),"line-blur":new a(c.paint_line["line-blur"]),"line-dasharray":new n(c.paint_line["line-dasharray"]),"line-pattern":new r(c.paint_line["line-pattern"]),"line-gradient":new i(c.paint_line["line-gradient"])}),d={paint:y,layout:h},m=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,r){return r=new s(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),t.prototype.possiblyEvaluate.call(this,e,r)},e.prototype.evaluate=function(e,r,n,i){return r=extend({},r,{zoom:Math.floor(r.zoom)}),t.prototype.evaluate.call(this,e,r,n,i)},e}(a),v=new m(d.paint.properties["line-width"].specification);return v.useIntegerZoom=!0,function(r){function n(t){r.call(this,t,d)}function i(t,e){return e>0?e+2*t:t}function o(e,r){for(var n=[],i=new t(0,0),o=0;o<e.length;o++){for(var a=e[o],s=[],u=0;u<a.length;u++){var l=a[u-1],p=a[u],c=a[u+1],f=0===u?i:p.sub(l)._unit()._perp(),h=u===a.length-1?i:c.sub(p)._unit()._perp(),y=f._add(h)._unit(),d=y.x*h.x+y.y*h.y;y._mult(1/d),s.push(y._mult(r)._add(p))}n.push(s)}return n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},n.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=renderColorRamp(t,"lineProgress"),this.gradientTexture=null},n.prototype.recalculate=function(t,e){r.prototype.recalculate.call(this,t,e),this.paint._values["line-floorwidth"]=v.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},n.prototype.createBucket=function(t){return new e(t)},n.prototype.queryRadius=function(t){var e=t,r=i(l.getMaximumPaintValue("line-width",this,e),l.getMaximumPaintValue("line-gap-width",this,e)),n=l.getMaximumPaintValue("line-offset",this,e);return r/2+Math.abs(n)+l.translateDistance(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(t,e,r,n,a,s,u){var p=l.translate(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),0,u),c=u/2*i(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),h=this.paint.get("line-offset").evaluate(e,r);return h&&(n=o(n,h*u)),f.polygonIntersectsBufferedMultiLine(p,n,c)},n.prototype.isTileClipped=function(){return!0},n}(p)}),define("MVT/data/bucket/symbol_attributes",["../../util/createLayout"],function(t){"use strict";function e(){}return e.symbolLayoutAttributes=t([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),e.dynamicLayoutAttributes=t([{name:"a_projected_pos",components:3,type:"Float32"}],4),e.placementOpacityAttributes=t([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),e.collisionVertexAttributes=t([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),e.collisionBox=t([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),e.collisionBoxLayout=t([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),e.collisionCircleLayout=t([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),e.placement=t([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),e.symbolInstance=t([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"}]),e.glyphOffset=t([{type:"Float32",name:"offsetX"}]),e.lineVertex=t([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),e}),define("MVT/symbol/mergeLines",[],function(){function t(t){function e(e){s.push(t[e]),u++}function r(t,e,r){var n=a[t];return delete a[t],a[e]=n,s[n].geometry[0].pop(),s[n].geometry[0]=s[n].geometry[0].concat(r[0]),n}function n(t,e,r){var n=o[e];return delete o[e],o[t]=n,s[n].geometry[0].shift(),s[n].geometry[0]=r[0].concat(s[n].geometry[0]),n}function i(t,e,r){var n=r?e[0][e[0].length-1]:e[0][0];return t+":"+n.x+":"+n.y}for(var o={},a={},s=[],u=0,l=0;l<t.length;l++){var p=t[l],c=p.geometry,f=p.text?p.text.toString():null;if(f){var h=i(f,c),y=i(f,c,!0);if(h in a&&y in o&&a[h]!==o[y]){var d=n(h,y,c),m=r(h,y,s[d].geometry);delete o[h],delete a[y],a[i(f,s[m].geometry,!0)]=m,s[d].geometry=null}else h in a?r(h,y,c):y in o?n(h,y,c):(e(l),o[h]=u-1,a[y]=u-1)}else e(l)}return s.filter(function(t){return t.geometry})}return t}),define("MVT/symbol/one_em",[],function(){return 24}),define("MVT/symbol/shaping",["../util/web_worker_transfer","../pointGeometry","./one_em"],function(t,e,r){function n(t){for(var e=0,r=t;e<r.length;e+=1){if(0!==r[e].positionedGlyphs.length)return!1}return!0}function i(t,e){for(var r=[],n=t.text,i=0,o=0,a=e;o<a.length;o+=1){var s=a[o];r.push(t.substring(i,s)),i=s}return i<n.length&&r.push(t.substring(i,n.length)),r}function o(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}var a=function(){};a.WritingMode={horizontal:1,vertical:2,horizontalOnly:3};var s=function(){this.scale=1,this.fontStack="",this.imageName=null};s.forText=function(t,e){var r=new s;return r.scale=t||1,r.fontStack=e,r},s.forImage=function(t){var e=new s;return e.imageName=t,e};var u=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};u.fromFeature=function(t,e){for(var r=new u,n=0;n<t.sections.length;n++){var i=t.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,e)}return r},u.prototype.length=function(){return this.text.length},u.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},u.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},u.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},u.prototype.verticalizePunctuation=function(){},u.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&l[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,n=this.text.length-1;n>=0&&n>=t&&l[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},u.prototype.substring=function(t,e){var r=new u;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},u.prototype.toString=function(){return this.text},u.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,r){return Math.max(e,t.sections[r].scale)},0)},u.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(s.forText(t.scale,t.fontStack||e));for(var r=this.sections.length-1,n=0;n<t.text.length;++n)this.sectionIndex.push(r)},u.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var r=this.getNextImageSectionCharCode();r&&(this.text+=String.fromCharCode(r),this.sections.push(s.forImage(e)),this.sectionIndex.push(this.sections.length-1))}},u.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)},a.shapeText=function(t,e,r,o,s,l,p,c,f,h,y,d,m,v,g,x){var b=u.fromFeature(t,s);d===a.WritingMode.vertical&&b.verticalizePunctuation();var w,_=null,C=null;if(_&&1===b.sections.length){w=[];for(var A=_(b.toString(),void 0),S=0,E=A;S<E.length;S+=1){var k=E[S],I=new u;I.text=k,I.sections=b.sections;for(var F=0;F<k.length;F++)I.sectionIndex.push(0);w.push(I)}}else if(C){w=[];for(var V=C(b.text,b.sectionIndex,void 0),M=0,P=V;M<P.length;M+=1){var T=P[M],z=new u;z.text=T[0],z.sectionIndex=T[1],z.sections=b.sections,w.push(z)}}else w=i(b,void 0);var B=[],O={positionedLines:B,text:b.toString(),top:y[1],bottom:y[1],left:y[0],right:y[0],writingMode:d,iconsInText:!1,verticalizable:!1};return!n(B)&&O};var l={};l[9]=!0,l[10]=!0,l[11]=!0,l[12]=!0,l[13]=!0,l[32]=!0;var p={};return p[10]=!0,p[32]=!0,p[38]=!0,p[40]=!0,p[41]=!0,p[43]=!0,p[45]=!0,p[47]=!0,p[173]=!0,p[183]=!0,p[8203]=!0,p[8208]=!0,p[8211]=!0,p[8231]=!0,a.shapeIcon=function(t,e,r){var n=o(r),i=n.horizontalAlign,a=n.verticalAlign,s=e[0],u=e[1],l=s-t.displaySize[0]*i,p=l+t.displaySize[0],c=u-t.displaySize[1]*a;return{image:t,top:c,bottom:c+t.displaySize[1],left:l,right:p}},a.fitIconToText=function(t,e,r,n,i,o){var a,s=t.image;if(s.content){var u=s.content,l=s.pixelRatio||1;a=[u[0]/l,u[1]/l,s.displaySize[0]-u[2]/l,s.displaySize[1]-u[3]/l]}var p,c,f,h,y=e.left*o,d=e.right*o;"width"===r||"both"===r?(h=i[0]+y-n[3],c=i[0]+d+n[1]):(h=i[0]+(y+d-s.displaySize[0])/2,c=h+s.displaySize[0]);var m=e.top*o,v=e.bottom*o;return"height"===r||"both"===r?(p=i[1]+m-n[0],f=i[1]+v+n[2]):(p=i[1]+(m+v-s.displaySize[1])/2,f=p+s.displaySize[1]),{image:s,top:p,right:c,bottom:f,left:h,collisionPadding:a}},a}),define("MVT/symbol/symbol_size",["../style/evaluation_parameters"],function(t){function e(e,r){var n=r.expression;if("constant"===n.kind){return{kind:"constant",layoutSize:n.evaluate(new t(e+1))}}if("source"===n.kind)return{kind:"source"};for(var i=n.zoomStops,o=n.interpolationType,a=0;a<i.length&&i[a]<=e;)a++;a=Math.max(0,a-1);for(var s=a;s<i.length&&i[s]<e+1;)s++;s=Math.min(i.length-1,s);var u=i[a],l=i[s];return"composite"===n.kind?{kind:"composite",minZoom:u,maxZoom:l,interpolationType:o}:{kind:"camera",minZoom:u,maxZoom:l,minSize:n.evaluate(new t(u)),maxSize:n.evaluate(new t(l)),interpolationType:o}}function r(t,e,r){var n=e.uSize,o=e.uSizeT,a=r.lowerSize,s=r.upperSize;return"source"===t.kind?a/i:"composite"===t.kind?number(a/i,s/i,o):n}function n(t,e){var r=0,n=0;if("constant"===t.kind)n=t.layoutSize;else if("source"!==t.kind){t.interpolationType,t.minZoom,t.maxZoom;"camera"===t.kind?n=number(t.minSize,t.maxSize,0):r=0}return{uSizeT:r,uSize:n}}var i=128;return Object.freeze({__proto__:null,getSizeData:e,evaluateSizeForFeature:r,evaluateSizeForZoom:n,SIZE_PACK_FACTOR:i})}),define("MVT/symbol/transform_text",[],function(){function t(t,e,r){var n=e.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?t=t.toLocaleUpperCase():"lowercase"===n&&(t=t.toLocaleLowerCase()),t}function e(e,r,n){return e.sections.forEach(function(e){e.text=t(e.text,r,n)}),e}return e}),define("MVT/util/is_char_in_unicode_block",[],function(){"use strict";return{"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}}}),define("MVT/util/script_detection",["./is_char_in_unicode_block"],function(t){"use strict";function e(e){return!t.Arabic(e)&&(!t["Arabic Supplement"](e)&&(!t["Arabic Extended-A"](e)&&(!t["Arabic Presentation Forms-A"](e)&&!t["Arabic Presentation Forms-B"](e))))}function r(e){return 746===e||747===e||!(e<4352)&&(!!t["Bopomofo Extended"](e)||(!!t.Bopomofo(e)||(!(!t["CJK Compatibility Forms"](e)||e>=65097&&e<=65103)||(!!t["CJK Compatibility Ideographs"](e)||(!!t["CJK Compatibility"](e)||(!!t["CJK Radicals Supplement"](e)||(!!t["CJK Strokes"](e)||(!(!t["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||(!!t["CJK Unified Ideographs Extension A"](e)||(!!t["CJK Unified Ideographs"](e)||(!!t["Enclosed CJK Letters and Months"](e)||(!!t["Hangul Compatibility Jamo"](e)||(!!t["Hangul Jamo Extended-A"](e)||(!!t["Hangul Jamo Extended-B"](e)||(!!t["Hangul Jamo"](e)||(!!t["Hangul Syllables"](e)||(!!t.Hiragana(e)||(!!t["Ideographic Description Characters"](e)||(!!t.Kanbun(e)||(!!t["Kangxi Radicals"](e)||(!!t["Katakana Phonetic Extensions"](e)||(!(!t.Katakana(e)||12540===e)||(!(!t["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||(!(!t["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||(!!t["Unified Canadian Aboriginal Syllabics"](e)||(!!t["Unified Canadian Aboriginal Syllabics Extended"](e)||(!!t["Vertical Forms"](e)||(!!t["Yijing Hexagram Symbols"](e)||(!!t["Yi Syllables"](e)||!!t["Yi Radicals"](e))))))))))))))))))))))))))))))}function n(e){return e>=1424&&e<=2303||t["Arabic Presentation Forms-A"](e)||t["Arabic Presentation Forms-B"](e)}var i=function(){};return i.allowsVerticalWritingMode=function(t){for(var e=0,n=t;e<n.length;e+=1){if(r(n[e].charCodeAt(0)))return!0}return!1},i.allowsLetterSpacing=function(t){for(var r=0,n=t;r<n.length;r+=1){if(!e(n[r].charCodeAt(0)))return!1}return!0},i.stringContainsRTLText=function(t){for(var e=0,r=t;e<r.length;e+=1){if(n(r[e].charCodeAt(0)))return!0}return!1},i}),define("MVT/data/bucket/symbol_bucket",["./symbol_attributes","../../util/web_worker_transfer","../../style/evaluation_parameters","../load_geometry","../segment","../StructArrayLayout2ui4","../StructArrayLayout3ui6","../programConfigurationSet","../../symbol/mergeLines","../../symbol/shaping","../../symbol/symbol_size","../../symbol/transform_text","../../style-spec/expression/types/formatted","../../style-spec/expression/types/resolved_image","../../util/script_detection"],function(t,e,r,n,i,o,a,s,u,l,p,c,f,h,y){"use strict";function d(t,e,r,n,i,o,a,s,u,l,p,c,f){var h=s?Math.min(MAX_PACKED_SIZE,Math.round(s[0])):0,y=s?Math.min(MAX_PACKED_SIZE,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(32*n),Math.round(32*i),o,a,(h<<1)+(u?1:0),y,16*l,16*p,256*c,256*f)}function m(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function v(t){for(var e=0,r=t.sections;e<r.length;e+=1){var n=r[e];if(y.stringContainsRTLText(n.text))return!0}return!1}var g=["Unknown","Point","LineString","Polygon"],x=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],b=function(t){this.layoutVertexArray=new StructArrayLayout4i4ui4i24,this.indexArray=new a,this.programConfigurations=t,this.segments=new i,this.dynamicLayoutVertexArray=new StructArrayLayout3f12,this.opacityVertexArray=new StructArrayLayout1ul4,this.placedSymbolArray=new PlacedSymbolArray};b.prototype.upload=function(e,r,n,i){n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,t.symbolLayoutAttributes.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,t.dynamicLayoutAttributes.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,x,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e)},b.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},b.prototype.clear=function(){},e.register("SymbolBuffers",b);var w=function(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new i,this.collisionVertexArray=new StructArrayLayout2ub2f12};w.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,collisionVertexAttributes.members,!0)},w.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},e.register("CollisionBuffers",w);var _=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasPaintOverrides=!1,this.hasRTLText=!1;var e=this.layers[0],r=e._unevaluatedLayout._values;this.textSizeData=p.getSizeData(this.zoom,r["text-size"]),this.iconSizeData=p.getSizeData(this.zoom,r["icon-size"]);var n=this.layers[0].layout,i=n.get("symbol-sort-key"),o=n.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==o&&void 0!==i.constantOr(1);var a="viewport-y"===o||"auto"===o&&!this.sortFeaturesByKey;this.sortFeaturesByY=a&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")),"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map(function(t){return l.WritingMode[t]})),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id}),this.sourceID=t.sourceID};return _.prototype.createArrays=function(){},_.prototype.calculateGlyphDependencies=function(t,e,r,n,i){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(r||n)&&i){var a=verticalizedCharacterMap[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},_.prototype.populate=function(t,e){var i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),p=o.get("icon-image"),d=("constant"!==s.value.kind||s.value.value instanceof f&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),m=("constant"!==p.value.kind||!!p.value.value)&&Object.keys(p.parameters).length>0,x=o.get("symbol-sort-key");if(this.features=[],d||m){for(var b=e.iconDependencies,w=e.glyphDependencies,_=e.availableImages,C=new r(this.zoom),A=0,S=t;A<S.length;A+=1){var E=S[A],k=E.feature,I=E.index,F=E.sourceLayerIndex;if(i._featureFilter(C,k)){var V=void 0;if(d){var M=i.getValueAndResolveTokens("text-field",k,_),P=f.factory(M);v(P)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===getRTLTextPluginStatus()||this.hasRTLText&&plugin.isParsed())&&(V=c(P,i,k))}var T=void 0;if(m){var z=i.getValueAndResolveTokens("icon-image",k,_);T=z instanceof h?z:h.fromString(z)}if(V||T){var B=this.sortFeaturesByKey?x.evaluate(k,{}):void 0,O={text:V,icon:T,index:I,sourceLayerIndex:F,geometry:n(k),properties:k.properties,type:g[k.type],sortKey:B};if(void 0!==k.id&&(O.id=k.id),this.features.push(O),T&&(b[T.name]=!0),V){var D=a.evaluate(k,{}).join(","),L="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(var R=0,q=V.sections;R<q.length;R+=1){var U=q[R];if(U.image)b[U.image.name]=!0;else{var N=y.allowsVerticalWritingMode(V.toString()),j=U.fontStack||D,G=w[j]=w[j]||{};this.calculateGlyphDependencies(U.text,G,L,this.allowVerticalPlacement,N)}}}}}}"line"===o.get("symbol-placement")&&(this.features=u(this.features)),this.sortFeaturesByKey&&this.features.sort(function(t,e){return t.sortKey-e.sortKey})}},_.prototype.update=function(t,e,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r))},_.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},_.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},_.prototype.upload=function(t){},_.prototype.destroy=function(){},_.prototype.clear=function(){},_.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(void 0!==t.segment){for(var n=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:n},a<e.length-1&&(n+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var u=0;u<e.length;u++){var l=o[u];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},_.prototype.addSymbols=function(t,e,r,n,i,o,a,s,u,p,c){
var f=this,h=t.indexArray,y=t.layoutVertexArray,v=t.dynamicLayoutVertexArray,g=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray,o.sortKey),x=this.glyphOffsetArray.length,b=g.vertexLength,w=this.allowVerticalPlacement&&a===l.WritingMode.vertical?Math.PI/2:0,_=function(t){var e=t.tl,n=t.tr,i=t.bl,o=t.br,a=t.tex,u=t.pixelOffsetTL,l=t.pixelOffsetBR,p=t.minFontScaleX,c=t.minFontScaleY,x=g.vertexLength,b=t.glyphOffset[1];d(y,s.x,s.y,e.x,b+e.y,a.x,a.y,r,t.isSDF,u.x,u.y,p,c),d(y,s.x,s.y,n.x,b+n.y,a.x+a.w,a.y,r,t.isSDF,l.x,u.y,p,c),d(y,s.x,s.y,i.x,b+i.y,a.x,a.y+a.h,r,t.isSDF,u.x,l.y,p,c),d(y,s.x,s.y,o.x,b+o.y,a.x+a.w,a.y+a.h,r,t.isSDF,l.x,l.y,p,c),m(v,s,w),h.emplaceBack(x,x+1,x+2),h.emplaceBack(x+1,x+2,x+3),g.vertexLength+=4,g.primitiveLength+=2,f.glyphOffsetArray.emplaceBack(t.glyphOffset[0])};if(o.text&&o.text.sections){var C=o.text.sections;if(this.hasPaintOverrides){for(var A,S=function(e,r){void 0===A||A===e&&!r||t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{},C[A]),A=e},E=0,k=e;E<k.length;E+=1){var I=k[E];S(I.sectionIndex,!1),_(I)}S(A,!0)}else{for(var F=0,V=e;F<V.length;F+=1){_(V[F])}t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{},C[0])}}else{for(var M=0,P=e;M<P.length;M+=1){_(P[M])}t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{})}t.placedSymbolArray.emplaceBack(s.x,s.y,x,this.glyphOffsetArray.length-x,b,u,p,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],a,0,!1,0,c)},_.prototype._addCollisionDebugVertex=function(t,e,r,n,i,o){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,n,i,Math.round(o.x),Math.round(o.y))},_.prototype.addCollisionDebugVertices=function(t,e,r,n,i,o,a,s){var u=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=u.vertexLength,p=i.layoutVertexArray,c=i.collisionVertexArray,f=a.anchorX,h=a.anchorY;if(this._addCollisionDebugVertex(p,c,o,f,h,new pointGeometry(t,e)),this._addCollisionDebugVertex(p,c,o,f,h,new pointGeometry(r,e)),this._addCollisionDebugVertex(p,c,o,f,h,new pointGeometry(r,n)),this._addCollisionDebugVertex(p,c,o,f,h,new pointGeometry(t,n)),u.vertexLength+=4,s){var y=i.indexArray;y.emplaceBack(l,l+1,l+2),y.emplaceBack(l,l+2,l+3),u.primitiveLength+=2}else{var d=i.indexArray;d.emplaceBack(l,l+1),d.emplaceBack(l+1,l+2),d.emplaceBack(l+2,l+3),d.emplaceBack(l+3,l),u.primitiveLength+=4}},_.prototype.addDebugCollisionBoxes=function(t,e,r,n){for(var i=t;i<e;i++){var o=this.collisionBoxArray.get(i),a=o.x1,s=o.y1,u=o.x2,l=o.y2,p=o.radius>0;this.addCollisionDebugVertices(a,s,u,l,p?n?this.textCollisionCircle:this.iconCollisionCircle:n?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,r,p)}},_.prototype.generateCollisionDebugBuffers=function(){for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},_.prototype._deserializeCollisionBoxesForSymbol=function(t,e,r,n,i,o,a,s,u){for(var l={},p=e;p<r;p++){var c=t.get(p);if(0===c.radius){l.textBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY},l.textFeatureIndex=c.featureIndex;break}l.textCircles||(l.textCircles=[],l.textFeatureIndex=c.featureIndex);l.textCircles.push(c.anchorPointX,c.anchorPointY,c.radius,c.signedDistanceFromAnchor,1)}for(var f=n;f<i;f++){var h=t.get(f);if(0===h.radius){l.verticalTextBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},l.verticalTextFeatureIndex=h.featureIndex;break}}for(var y=o;y<a;y++){var d=t.get(y);if(0===d.radius){l.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},l.iconFeatureIndex=d.featureIndex;break}}for(var m=s;m<u;m++){var v=t.get(m);if(0===v.radius){l.verticalIconBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY},l.verticalIconFeatureIndex=v.featureIndex;break}}return l},_.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},_.prototype.hasTextData=function(){return this.text.segments.get().length>0},_.prototype.hasIconData=function(){return this.icon.segments.get().length>0},_.prototype.hasTextCollisionBoxData=function(){return this.textCollisionBox.segments.get().length>0},_.prototype.hasIconCollisionBoxData=function(){return this.iconCollisionBox.segments.get().length>0},_.prototype.hasTextCollisionCircleData=function(){return this.textCollisionCircle.segments.get().length>0},_.prototype.hasIconCollisionCircleData=function(){return this.iconCollisionCircle.segments.get().length>0},_.prototype.addIndicesForPlacedSymbol=function(t,e){for(var r=t.placedSymbolArray.get(e),n=r.vertexStartIndex+4*r.numGlyphs,i=r.vertexStartIndex;i<n;i+=4)t.indexArray.emplaceBack(i,i+1,i+2),t.indexArray.emplaceBack(i+1,i+2,i+3)},_.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),r=Math.cos(t),n=[],i=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);n.push(0|Math.round(e*s.anchorX+r*s.anchorY)),i.push(s.featureIndex)}return o.sort(function(t,e){return n[t]-n[e]||i[e]-i[t]}),o},_.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,n=this.symbolInstanceIndexes;r<n.length;r+=1){var i=n[r],o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach(function(t,r,n){t>=0&&n.indexOf(t)===r&&e.addIndicesForPlacedSymbol(e.text,t)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},e.register("SymbolBucket",_,{omit:["layers","collisionBoxArray","compareText"]}),_.MAX_GLYPHS=65535,_.addDynamicAttributes=m,_}),define("MVT/style/style_layer/symbol_style_layer",["../../data/bucket/symbol_bucket","../crossFadedDataDrivenProperty","../dataConstantProperty","../dataDrivenProperty","../properties","../query_utils","../style_layer","../style_spec","../../util/util","../../style-spec/expression/expression","../../style-spec/expression/types/formatted","../../style-spec/expression/definitions/format","../../style-spec/expression/definitions/literal","../../style-spec/expression/values"],function(t,e,r,n,i,o,a,s,u,l,p,c,f,h){"use strict";var y={kind:"color"},d={kind:"formatted"},m=new i({"symbol-placement":new r(s.layout_symbol["symbol-placement"]),"symbol-spacing":new r(s.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new r(s.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new n(s.layout_symbol["symbol-sort-key"]),"symbol-z-order":new r(s.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new r(s.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new r(s.layout_symbol["icon-ignore-placement"]),"icon-optional":new r(s.layout_symbol["icon-optional"]),"icon-rotation-alignment":new r(s.layout_symbol["icon-rotation-alignment"]),"icon-size":new n(s.layout_symbol["icon-size"]),"icon-text-fit":new r(s.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new r(s.layout_symbol["icon-text-fit-padding"]),"icon-image":new n(s.layout_symbol["icon-image"]),"icon-rotate":new n(s.layout_symbol["icon-rotate"]),"icon-padding":new r(s.layout_symbol["icon-padding"]),"icon-keep-upright":new r(s.layout_symbol["icon-keep-upright"]),"icon-offset":new n(s.layout_symbol["icon-offset"]),"icon-anchor":new n(s.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new r(s.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new r(s.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new r(s.layout_symbol["text-rotation-alignment"]),"text-field":new n(s.layout_symbol["text-field"]),"text-font":new n(s.layout_symbol["text-font"]),"text-size":new n(s.layout_symbol["text-size"]),"text-max-width":new n(s.layout_symbol["text-max-width"]),"text-line-height":new r(s.layout_symbol["text-line-height"]),"text-letter-spacing":new n(s.layout_symbol["text-letter-spacing"]),"text-justify":new n(s.layout_symbol["text-justify"]),"text-radial-offset":new n(s.layout_symbol["text-radial-offset"]),"text-variable-anchor":new r(s.layout_symbol["text-variable-anchor"]),"text-anchor":new n(s.layout_symbol["text-anchor"]),"text-max-angle":new r(s.layout_symbol["text-max-angle"]),"text-writing-mode":new r(s.layout_symbol["text-writing-mode"]),"text-rotate":new n(s.layout_symbol["text-rotate"]),"text-padding":new r(s.layout_symbol["text-padding"]),"text-keep-upright":new r(s.layout_symbol["text-keep-upright"]),"text-transform":new n(s.layout_symbol["text-transform"]),"text-offset":new n(s.layout_symbol["text-offset"]),"text-allow-overlap":new r(s.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new r(s.layout_symbol["text-ignore-placement"]),"text-optional":new r(s.layout_symbol["text-optional"])}),v=new i({"icon-opacity":new n(s.paint_symbol["icon-opacity"]),"icon-color":new n(s.paint_symbol["icon-color"]),"icon-halo-color":new n(s.paint_symbol["icon-halo-color"]),"icon-halo-width":new n(s.paint_symbol["icon-halo-width"]),"icon-halo-blur":new n(s.paint_symbol["icon-halo-blur"]),"icon-translate":new r(s.paint_symbol["icon-translate"]),"icon-translate-anchor":new r(s.paint_symbol["icon-translate-anchor"]),"text-opacity":new n(s.paint_symbol["text-opacity"]),"text-color":new n(s.paint_symbol["text-color"],{runtimeType:y,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new n(s.paint_symbol["text-halo-color"]),"text-halo-width":new n(s.paint_symbol["text-halo-width"]),"text-halo-blur":new n(s.paint_symbol["text-halo-blur"]),"text-translate":new r(s.paint_symbol["text-translate"]),"text-translate-anchor":new r(s.paint_symbol["text-translate-anchor"])}),g={paint:v,layout:m};return function(e){function r(t){e.call(this,t,g)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.recalculate=function(t,r){if(e.prototype.recalculate.call(this,t,r),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var n=this.layout.get("text-writing-mode");if(n){for(var i=[],o=0,a=n;o<a.length;o+=1){var s=a[o];i.indexOf(s)<0&&i.push(s)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},r.prototype.getValueAndResolveTokens=function(t,e,r){var n=this.layout.get(t).evaluate(e,{},r),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||l.isExpression(i.value)||!n?n:u.resolveTokens(e.properties,n)},r.prototype.createBucket=function(e){return new t(e)},r.prototype.queryRadius=function(){return 0},r.prototype.queryIntersectsFeature=function(){return assert_1(!1),!1},r.prototype._setPaintOverrides=function(){for(var t=0,e=g.paint.overridableProperties;t<e.length;t+=1){var n=e[t];if(r.hasPaintOverride(this.layout,n)){var i=this.paint.get(n),o=new FormatSectionOverride(i),a=new StyleExpression(o,i.property.specification),s=null;s="constant"===i.value.kind||"source"===i.value.kind?new ZoomConstantExpression("source",a):new ZoomDependentExpression("composite",a,i.value.zoomStops,i.value._interpolationType),this.paint._values[n]=new PossiblyEvaluatedPropertyValue(i.property,s,i.parameters)}}},r.prototype._handleOverridablePaintPropertyUpdate=function(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&r.hasPaintOverride(this.layout,t)},r.hasPaintOverride=function(t,e){var r=t.get("text-field"),n=g.paint.properties[e],i=!1,o=function(t){for(var e=0,r=t;e<r.length;e+=1){var o=r[e];if(n.overrides&&n.overrides.hasOverride(o))return void(i=!0)}};if("constant"===r.value.kind&&r.value.value instanceof p)o(r.value.value.sections);else if("source"===r.value.kind){var a=function(t){if(!i)if(t instanceof f&&h.typeOf(t.value)===d){var e=t.value;o(e.sections)}else t instanceof c?o(t.sections):t.eachChild(a)},s=r.value;s._styleExpression&&a(s._styleExpression.expression)}return i},r.hasPaintOverrides=function(t){for(var e=0,n=g.paint.overridableProperties;e<n.length;e+=1){var i=n[e];if(r.hasPaintOverride(t,i))return!0}return!1},r}(a)}),define("MVT/style/create_style_layer",["./style_layer/circle_style_layer","./style_layer/fill_style_layer","./style_layer/line_style_layer","./style_layer/symbol_style_layer"],function(t,e,r,n){"use strict";function i(t){return o[t.type]?new o[t.type](t):null}var o={circle:t,fill:e,line:r,symbol:n};return i}),define("MVT/style/StyleIndexLayer",["../style-spec/feature_filter/featureFilter","../group_by_layout","./create_style_layer"],function(t,e,r){"use strict";function n(t){var e=[];for(var r in t)e.push(t[r]);return e}var i=function(t){this.keyCache={},t&&this.replace(t)};return i.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},i.prototype.update=function(i,o){for(var a=this,s=0,u=i;s<u.length;s+=1){var l=u[s];this._layerConfigs[l.id]=l;var p=r(l);null!=p&&(this._layers[l.id]=p,p._featureFilter=t.createFilter(p.filter),this.keyCache[l.id]&&delete this.keyCache[l.id])}for(var c=0,f=o;c<f.length;c+=1){var h=f[c];delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h]}this.familiesBySource={};for(var y=e(n(this._layerConfigs),this.keyCache),d=0,m=y;d<m.length;d+=1){var v=m[d],g=v.map(function(t){return a._layers[t.id]}),x=g[0];if(void 0!=x&&"none"!==x.visibility){var b=x.source||"",w=this.familiesBySource[b];w||(w=this.familiesBySource[b]={});var _=x.sourceLayer,C=w[_];C||(C=w[_]=[]),C.push(g)}}},i}),define("Workers/MVTWorkTile",["./createTaskProcessorWorker","../Core/Color","../Core/defaultValue","../Core/defined","../ThirdParty/pbf","../MVT/DictionaryCoder","../MVT/data/bucket/line_bucket","../MVT/data/bucket/fill_bucket","../MVT/data/feature_index","../MVT/render/image_atlas","../MVT/style/StyleIndexLayer","../MVT/style/evaluation_parameters","../MVT/vectortile","../MVT/util/web_worker_transfer"],function(t,e,r,n,i,o,a,s,u,l,p,c,f,h){"use strict";function y(t,e){var r=t.pbfData,i=t.layers,o=t.imageMap,a=h.deserialize(t.serializeObj),s=a.featureIndex,l=t.tileID.z;n(s)||(s=new u(t.tileID),s.bucketLayerIDs=[]);var c={};try{var f=new p(i);c=m(d(r),f,o,s,l),c=h.serialize(c,e)}catch(t){}return c}function d(t){if(n(t))return new f(new i(t))}function m(t,e,r,n,i){var u=new o(Object.keys(t.layers).sort()),p={},c={featureIndex:n,iconDependencies:{},patternDependencies:{},glyphDependencies:{}};for(var f in e.familiesBySource)if(""!=f){var h=e.familiesBySource[f];for(var y in h){var d=t.layers[y];if(d){for(var m=u.encode(y),g=[],x=0;x<d.length;x++){var b=d.feature(x);g.push({feature:b,index:x,sourceLayerIndex:m})}for(var w=0,_=h[y];w<_.length;w+=1){var C=_[w],A=C[0];if("none"!==A.visibility){v(C,0,null);var S=p[A.id]=A.createBucket({index:n.bucketLayerIDs.length,layers:C,sourceLayerIndex:m});S.populate(g,c),n.bucketLayerIDs.push(C.map(function(t){return t.id}))}}}}}var E=null;for(var k in p){var S=p[k];S.hasPattern&&(S instanceof a||S instanceof s)&&(null==E&&(E=new l({},r)),S.addFeatures(c,E.patternPositions))}return{buckets:p,imageAtlas:E,featureIndex:n}}function v(t,e,r){for(var n=new c(e),i=0,o=t;i<o.length;i+=1){o[i].recalculate(n,r)}}return h.register("FeatureIndex",u,{omit:["rawTileData","sourceLayerCoder"]}),t(y)})}();